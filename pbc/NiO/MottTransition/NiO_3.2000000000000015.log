Discarded 16 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /project/lgagliardi/jangidbhavnesh/Re/Final/MottTransition/NewGeometry/NiO.py ****
import os, sys
import shutil
import numpy as np
import scipy.linalg as la
from pyscf.pbc import scf, gto, df, dft, tools
from pyscf.tools import molden
from pyscf import mcpdft, lib, mcscf
from pyscf.mcscf import avas,project_init_guess
from pyscf import mcscf, dmrgscf
from functools import reduce
from pyscf import __config__
from pyscf.pbc.tools import k2gamma
# Import mcpdft from mrh
from mrh.my_pyscf import mcpdft
from pyscf.tools import molden
pre_orth_method = getattr(__config__, 'pbc_scf_analyze_pre_orth_method', 'ANO')

def getCell(nd=2.085, spin=0, maxMem=200000, basis='def2SVP', pseudo=None):
    cell = gto.Cell()
    cell.a = [[2*nd, nd, nd], [nd, 2*nd, nd], [2*nd, 2*nd, 4*nd]]
    cell.atom= f'''
Ni 0 0 0
Ni {2*nd} {2*nd} {2*nd}
Ni {nd} {nd} {2*nd}
Ni {3*nd} {3*nd} {4*nd}
O {nd} {nd} {nd}
O {3*nd} {3*nd} {3*nd}
O {2*nd} {2*nd} {3*nd}
O {4*nd} {4*nd} {5*nd}
    '''
    cell.basis = basis
    cell.pseudo = pseudo
    cell.output=f'NiO_{nd}.log'
    cell.verbose=lib.logger.INFO
    cell.precision=1e-12
    cell.exp_to_discard=0.1
    cell.spin=0
    cell.max_memory = maxMem
    cell.build()
    return cell

def get_gdf(cell, filename, restart=True):
    if not os.path.exists(filename) or restart:
        gdf = df.GDF(cell)
        gdf._cderi_to_save = filename
        gdf.build()
    return filename

def initguess(mol, mf, ao_label: list, activespacesize:int):
    '''
    Based on the ao_label find the orb which has
    highest character of that ao
    '''
    from pyscf.lo import orth
    baslst = mol.search_ao_label(ao_label)
    assert len(baslst) >=activespacesize
    orbindex=[]
    if len(mf.mo_coeff) > 1:
        mo_coeff = mf.mo_coeff[0]
    else:
        mo_coeff = mf.mo_coeff
    
    nkpts, nao = 1, mf.mo_coeff.shape[1]
    s_sc = mf.get_ovlp()
    orth_coeff = orth.orth_ao(mol, 'meta_lowdin',pre_orth_ao=None, s=s_sc)
    C = reduce(np.dot,(orth_coeff.T.conj(), s_sc, mf.mo_coeff))
    for orb in baslst:
        ao = C[orb]
        A = np.argsort(ao*ao.conj())[-activespacesize:][::-1]
        for element in A:
            if element not in orbindex:
                orbindex.append(element)
                break
    orbind = [x+1 for x in orbindex]
    return sorted(orbind[:activespacesize])

def runSCF(cell,nd=2.085, Restricted=True, Unrestricted=False):
    '''
    Run the Hartree Fock
    '''
    if Restricted:
        kmf = scf.ROHF(cell).density_fit()
    elif Unrestricted:
        kmf = scf.UHF(cell).density_fit()
    else:
        raise NotImplementedError

    kmf.max_cycle=100
    kmf.chkfile = f'NiO_{nd}.chk'
    kmf.init_guess='chk'
    kmf.with_df._cderi = get_gdf(cell, kmf.chkfile.rstrip('.chk')+'.h5', restart=False)
    kmf.exxdiv = None
    kmf.conv_tol = 1e-10
    kmf.kernel()

    if not kmf.converged:
        kmf.newton().run()

    assert kmf, "mean-field didn't converge"
    return kmf

def getfrags(nfrags: int):
    '''
    If NiO is in POSCAR Format where first N-atoms are Ni and
    next N-atoms are O, then get the frag atom no
    '''
    assert nfrags>=1, "You should know what you are doing"
    frags = []
    offset = nfrags * 2
    for i in range(nfrags):
        frag = [i * 2, i * 2 + offset, i * 2 + 1, i * 2 + offset + 1]
        frags.append(frag)
    return frags

def runLASSCF(cell, kmf):
    nfrags = 2
    ncas = 10 
    nelec = 16
    norb  = tuple([ncas,]*nfrags)
    nele  = tuple([nelec,]*nfrags)
    nspin = tuple([1,]*nfrags)

    orblst = initguess(cell, kmf, ao_label=['Ni 3d', ], activespacesize=sum(norb))

    frags = getfrags(nfrags)
    from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
    las = LASSCF(kmf, norb, nele, spin_sub=nspin)
    sortedmo = las.sort_mo(orblst, kmf.mo_coeff)
    mo0 = las.localize_init_guess(frags, sortedmo)
    #mo0 = sortedmo
    molden.from_mo(cell, f'NiO.{nfrags}.las.molden', mo0[:, las.ncore:las.ncore+(ncas*nfrags)])
    las_weights,las_charges,las_spins,las_smults=genModelSpace(nfrags)
    las = las.state_average(las_weights,las_charges,las_spins,las_smults)
    elasci = las.lasci_(mo0)
    las.mo_coeff = mo0
    return las

# Model Space for the band gap
def genModelSpace(nfrags):
    las_charges = []
    las_spins = [] #2s
    las_smults = [] #2s+1

    las_charges += [[0]*nfrags]
    las_spins += [[0]*nfrags]
    las_smults += [[las_spins[0][0]+1]*nfrags]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(-idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    nrootspaces = len(las_charges)
    las_weights = np.ones(nrootspaces)/nrootspaces
    return las_weights,las_charges,las_spins,las_smults

def processlas(las):
    from periodiclas.tools import sign_control, util
    las.ci = sign_control.fix_sign(las)
    las.dump_spaces()
    return las

def runLASSI(las):
    from mrh.my_pyscf.lassi import lassi
    lsi = lassi.LASSI(las)
    energies_lassi, civecs_lassi = lsi.kernel()
    return lsi, energies_lassi

def runLASSIPDFT(lsi, states=[0]):
    from mrh.my_pyscf import mcpdft
    mc = mcpdft.LASSI(lsi, 'tPBE', states=states)
    energies = mc.kernel()[0]
    return energies

def getBANDGAP(nele, lsi, energies_lassi):
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [list(x) for x in stateidx]
    ip = 27.21139*(min(energies_lassi[stateidx[1]]) - min(energies_lassi[stateidx[0]]))
    ea = 27.21139*(min(energies_lassi[stateidx[0]]) - min(energies_lassi[stateidx[2]]))
    return ip, ea

def getNatorbOcc(nele, lsi):
    from mrh.my_pyscf.lassi.lassi import root_make_rdm12s
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [int(list(x)[0]) for x in stateidx]
    for state in stateidx:
        natorb_casdm1 = root_make_rdm12s (lsi, lsi.ci, lsi.si, state=state, opt=lsi.opt)[0].sum (0)
        mo_occ = lsi._las.canonicalize (natorb_casdm1=natorb_casdm1)[2]
        mo_occ = [x for x in mo_occ if 0 < x < 2]
        print("State-",state, mo_occ)

def savepickel(mf, lsi, pdftenergy=0, R=2.47):
    """
    Save the LAS Band Structure Data
    """

    from periodiclas.tools import sign_control, util
    civec = lsi.get_sivec_vacuum_shuffle(state=0)
    charges = util.las_charges(lsi._las)

    data = {"energies_lassi":lsi.e_roots,
            "energies_lassipdft":pdftenergy,
            "civecs":civec,
            "charges":charges,
            "dist":R,
            "mf_coeff":mf.mo_coeff,
            "mf_occ":mf.mo_occ,
            "mf_ene":mf.mo_energy}


if __name__ == "__main__":
    for nd in np.arange(1.5, 3.6, 0.1):
        cell =  getCell(nd, maxMem=500000, basis='gth-dzvp-molopt-sr', pseudo='gth-pade')
        kmf = runSCF(cell, nd, Restricted=True, Unrestricted=False)

        las = runLASSCF(cell, kmf)
        las = processlas(las)

        lsi,energies_lassi = runLASSI(las)
        IP_LASSI, EA_LASSI = getBANDGAP(32, lsi,energies_lassi)
        energies_mcpdft = runLASSIPDFT(lsi, states=[x for x in range(len(energies_lassi))])
        IP_PDFT, EA_PDFT = getBANDGAP(32, lsi,np.asarray(energies_mcpdft))
        
        savepickel(kmf, lsi, pdftenergy=energies_mcpdft, R=nd)

        print("Results: LASSI ", )
        print("Ionization Energy: ", IP_LASSI)
        print("ElectAtt   Energy: ", EA_LASSI)
        print("Band Gap: ", IP_LASSI-EA_LASSI)

        print("Results: PDFT", )
        print("Ionization Energy: ", IP_PDFT)
        print("ElectAtt   Energy: ", EA_PDFT)
        print("Band Gap: ", IP_PDFT-EA_PDFT)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0555.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 128
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.26.2  scipy 1.11.4  h5py 3.10.0
Date: Sat Mar 15 01:18:02 2025
PySCF version 2.8.0
PySCF path  /home/jangidbhavnesh/bin/pyscf
GIT ORIG_HEAD a0665c4a7bf54e33f01295b3eea390be7a17d76d
GIT HEAD (branch master) 6f6d3741bf42543e02ccaa1d4ef43d9bf83b3dda
mrh path  /home/jangidbhavnesh/bin/mrh
GIT ORIG_HEAD ed1f605b415d72e71fb56d97b9d163809b62b172
GIT HEAD (branch master) ea89791c15c26abd3b0f0efdeadd7a286ca4585a

[ENV] PYSCF_EXT_PATH /home/jangidbhavnesh/bin/pyscf:/home/jangidbhavnesh/bin/pyscf-forge:/home/jangidbhavnesh/bin/dmrgscf:/home/jangidbhavnesh/bin:
[CONFIG] conf_file /home/jangidbhavnesh/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 8
[INPUT] num. electrons = 96
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ni     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Ni     6.400000000000   6.400000000000   6.400000000000 AA   12.094247197216  12.094247197216  12.094247197216 Bohr   0.0
[INPUT]  3 Ni     3.200000000000   3.200000000000   6.400000000000 AA    6.047123598608   6.047123598608  12.094247197216 Bohr   0.0
[INPUT]  4 Ni     9.600000000000   9.600000000000  12.800000000000 AA   18.141370795825  18.141370795825  24.188494394433 Bohr   0.0
[INPUT]  5 O      3.200000000000   3.200000000000   3.200000000000 AA    6.047123598608   6.047123598608   6.047123598608 Bohr   0.0
[INPUT]  6 O      9.600000000000   9.600000000000   9.600000000000 AA   18.141370795825  18.141370795825  18.141370795825 Bohr   0.0
[INPUT]  7 O      6.400000000000   6.400000000000   9.600000000000 AA   12.094247197216  12.094247197216  18.141370795825 Bohr   0.0
[INPUT]  8 O     12.800000000000  12.800000000000  16.000000000000 AA   24.188494394433  24.188494394433  30.235617993041 Bohr   0.0

nuclear repulsion = -311.872681127616
number of shells = 28
number of NR pGTOs = 500
number of NR cGTOs = 156
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:    513038.45
lattice vectors  a1 [12.094247197, 6.047123599, 6.047123599]
                 a2 [6.047123599, 12.094247197, 6.047123599]
                 a3 [12.094247197, 12.094247197, 24.188494394]
dimension = 3
low_dim_ft_type = None
Cell volume = 1769.04
exp_to_discard = 0.1
rcut = 21.840927745318478 (nimgs = [3 3 2])
lattice sum = 1515 cells
precision = 1e-12
pseudo = gth-pade
ke_cutoff = 1563.543132532536
    = [265 265 529] mesh (37149025 PWs)


******** <class 'pyscf.pbc.df.df.GDF'> ********
auxbasis = None
exp_to_discard = 0.1
_cderi_to_save = NiO_3.2000000000000015.h5
len(kpts) = 1
ETB for O: l = 0, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 1, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 2, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 3, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 4, exps = 0.32498323008 * 2^n , n = 0..6
ETB for Ni: l = 0, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 1, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 2, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 3, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 4, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 5, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 6, exps = 0.689956484316 * 2^n , n = 0..4

WARN: Even tempered Gaussians are generated as DF auxbasis for  O Ni

Drop 0 primitive fitting functions
make aux basis, num shells = 280, num cGTOs = 1680
auxcell.rcut 14.405988831603228


******** <class 'pyscf.pbc.df.rsdf_builder._RSGDFBuilder'> ********
mesh = [17 17 31] (8959 PWs)
ke_cutoff = 5.060615330054806
omega = 0.23914900334241157
exclude_d_aux = True
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.scf.rohf.ROHF'> ********
method = ROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.2000000000000015.chk
max_memory 500000 MB (current use 25766 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f457c0ecc70>
number of electrons per cell  alpha = 48 beta = 48
Set gradient conv threshold to 1e-05

WARN: Fail in reading NiO_3.2000000000000015.chk. Use MINAO initial guess



******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
init E= -722.655072596852

WARN: HOMO 0.532922075744702 >= LUMO 0.533419672448172

cycle= 1 E= -714.717047491532  delta_E= 7.94  |g|= 8.91  |ddm|= 4.69
  HOMO = 0.333798603584583  LUMO = 0.340447158532496
cycle= 2 E= -679.660294930909  delta_E= 35.1  |g|= 11.5  |ddm|= 10.1
  HOMO = 0.272712922587665  LUMO = 0.415406343211449
cycle= 3 E= -720.809171072723  delta_E= -41.1  |g|= 4.82  |ddm|= 9.33
  HOMO = 0.098733699714526  LUMO = 0.384490126864087
cycle= 4 E= -724.431581197822  delta_E= -3.62  |g|= 2.39  |ddm|= 2.38
  HOMO = 0.0847291130227849  LUMO = 0.250213206144454
cycle= 5 E= -725.014843688013  delta_E= -0.583  |g|= 0.978  |ddm|= 0.885
  HOMO = 0.159952497080627  LUMO = 0.195777239608749
cycle= 6 E= -725.227667273397  delta_E= -0.213  |g|= 0.127  |ddm|= 0.682
  HOMO = 0.171995252801568  LUMO = 0.189391352148603
cycle= 7 E= -725.231280933516  delta_E= -0.00361  |g|= 0.0462  |ddm|= 0.234
  HOMO = 0.172822257927943  LUMO = 0.189669927933623
cycle= 8 E= -725.231797124819  delta_E= -0.000516  |g|= 0.00564  |ddm|= 0.112
  HOMO = 0.173136592827932  LUMO = 0.18954393364742
cycle= 9 E= -725.23184687341  delta_E= -4.97e-05  |g|= 0.00659  |ddm|= 0.0799
  HOMO = 0.173764831136501  LUMO = 0.1894957835128
cycle= 10 E= -725.231895672888  delta_E= -4.88e-05  |g|= 0.0022  |ddm|= 0.0299
  HOMO = 0.173923027863632  LUMO = 0.189494872488165
cycle= 11 E= -725.231900497962  delta_E= -4.83e-06  |g|= 0.00256  |ddm|= 0.0117
  HOMO = 0.173936783018451  LUMO = 0.189491892662793
cycle= 12 E= -725.231901899233  delta_E= -1.4e-06  |g|= 0.0024  |ddm|= 0.000836
  HOMO = 0.173938852876786  LUMO = 0.189493764192024
cycle= 13 E= -725.231902161056  delta_E= -2.62e-07  |g|= 0.00251  |ddm|= 0.000439
  HOMO = 0.173957069884382  LUMO = 0.189496840209015
cycle= 14 E= -725.231900463381  delta_E= 1.7e-06  |g|= 0.00252  |ddm|= 0.000982
  HOMO = 0.173821276672563  LUMO = 0.189630433458894
cycle= 15 E= -725.231831302327  delta_E= 6.92e-05  |g|= 0.00122  |ddm|= 0.06
  HOMO = 0.173708758443237  LUMO = 0.189687335328875
cycle= 16 E= -725.231806785996  delta_E= 2.45e-05  |g|= 0.00122  |ddm|= 0.0397
  HOMO = 0.173673715676947  LUMO = 0.189521574339028
cycle= 17 E= -725.231807350779  delta_E= -5.65e-07  |g|= 0.00123  |ddm|= 0.00309
  HOMO = 0.173680334581547  LUMO = 0.189551783337742
cycle= 18 E= -725.231807074742  delta_E= 2.76e-07  |g|= 0.000992  |ddm|= 0.00391
  HOMO = 0.173687177029578  LUMO = 0.189548532078363
cycle= 19 E= -725.231807038238  delta_E= 3.65e-08  |g|= 0.000924  |ddm|= 0.0026
  HOMO = 0.173676807902049  LUMO = 0.18954710360379
cycle= 20 E= -725.231808604233  delta_E= -1.57e-06  |g|= 0.000926  |ddm|= 0.00181
  HOMO = 0.173669857363517  LUMO = 0.189519360442604
cycle= 21 E= -725.231805176805  delta_E= 3.43e-06  |g|= 0.000924  |ddm|= 0.00383
  HOMO = 0.173675199834183  LUMO = 0.189531126946188
cycle= 22 E= -725.231796943394  delta_E= 8.23e-06  |g|= 0.000923  |ddm|= 0.0093
  HOMO = 0.173682549643507  LUMO = 0.189789169642258
cycle= 23 E= -725.231734507211  delta_E= 6.24e-05  |g|= 0.00164  |ddm|= 0.0721
  HOMO = 0.173687380612626  LUMO = 0.189903491548209
cycle= 24 E= -725.231710031642  delta_E= 2.45e-05  |g|= 0.00193  |ddm|= 0.0305
  HOMO = 0.173677009971623  LUMO = 0.189707344857967
cycle= 25 E= -725.231727514169  delta_E= -1.75e-05  |g|= 0.00129  |ddm|= 0.0212
  HOMO = 0.173641771023297  LUMO = 0.190931567828073
cycle= 26 E= -725.231635840444  delta_E= 9.17e-05  |g|= 0.00631  |ddm|= 0.105
  HOMO = 0.173641231232856  LUMO = 0.191047028790591
cycle= 27 E= -725.231627363861  delta_E= 8.48e-06  |g|= 0.00685  |ddm|= 0.00835
  HOMO = 0.173664388274673  LUMO = 0.190228756757467
cycle= 28 E= -725.23168615782  delta_E= -5.88e-05  |g|= 0.00367  |ddm|= 0.0647
  HOMO = 0.173689993360428  LUMO = 0.19021482945789
cycle= 29 E= -725.231689903655  delta_E= -3.75e-06  |g|= 0.00332  |ddm|= 0.00749
  HOMO = 0.173699411859311  LUMO = 0.190094695206454
cycle= 30 E= -725.231696410258  delta_E= -6.51e-06  |g|= 0.00276  |ddm|= 0.0101
  HOMO = 0.173692648813698  LUMO = 0.189776370513795
cycle= 31 E= -725.231726576975  delta_E= -3.02e-05  |g|= 0.0014  |ddm|= 0.0373
  HOMO = 0.173681321227045  LUMO = 0.18964557382233
cycle= 32 E= -725.231743368666  delta_E= -1.68e-05  |g|= 0.000952  |ddm|= 0.0212
  HOMO = 0.173682287378654  LUMO = 0.189628571793472
cycle= 33 E= -725.231745367203  delta_E= -2e-06  |g|= 0.000919  |ddm|= 0.00244
  HOMO = 0.173676658231415  LUMO = 0.189608566915592
cycle= 34 E= -725.231745906634  delta_E= -5.39e-07  |g|= 0.000901  |ddm|= 0.00249
  HOMO = 0.173692178298768  LUMO = 0.189638402534125
cycle= 35 E= -725.231748500239  delta_E= -2.59e-06  |g|= 0.000951  |ddm|= 0.00338
  HOMO = 0.173677800401292  LUMO = 0.189566446982919
cycle= 36 E= -725.231751722144  delta_E= -3.22e-06  |g|= 0.000853  |ddm|= 0.00436
  HOMO = 0.173674818868991  LUMO = 0.189513644289804
cycle= 37 E= -725.23174615922  delta_E= 5.56e-06  |g|= 0.000903  |ddm|= 0.00721
  HOMO = 0.173672391991763  LUMO = 0.189498451550715
cycle= 38 E= -725.231730151334  delta_E= 1.6e-05  |g|= 0.001  |ddm|= 0.0198
  HOMO = 0.173666816225594  LUMO = 0.189587838162351
cycle= 39 E= -725.231703256218  delta_E= 2.69e-05  |g|= 0.000873  |ddm|= 0.0363
  HOMO = 0.173672085794685  LUMO = 0.18960687239359
cycle= 40 E= -725.231697140119  delta_E= 6.12e-06  |g|= 0.000856  |ddm|= 0.00883
  HOMO = 0.173662837993754  LUMO = 0.189512156924204
cycle= 41 E= -725.231695869761  delta_E= 1.27e-06  |g|= 0.000924  |ddm|= 0.00234
  HOMO = 0.17369045188943  LUMO = 0.189441037099146
cycle= 42 E= -725.231698362423  delta_E= -2.49e-06  |g|= 0.00114  |ddm|= 0.00411
  HOMO = 0.173684858262257  LUMO = 0.189550219760005
cycle= 43 E= -725.231670259114  delta_E= 2.81e-05  |g|= 0.000918  |ddm|= 0.0419
  HOMO = 0.173694461626065  LUMO = 0.1897376911109
cycle= 44 E= -725.231636191358  delta_E= 3.41e-05  |g|= 0.00132  |ddm|= 0.0548
  HOMO = 0.17369347101985  LUMO = 0.189775592125473
cycle= 45 E= -725.231621254934  delta_E= 1.49e-05  |g|= 0.00161  |ddm|= 0.0272
  HOMO = 0.173693531529242  LUMO = 0.189886334460256
cycle= 46 E= -725.231614221447  delta_E= 7.03e-06  |g|= 0.00203  |ddm|= 0.0127
  HOMO = 0.173682997801296  LUMO = 0.189581102766671
cycle= 47 E= -725.231623345949  delta_E= -9.12e-06  |g|= 0.000857  |ddm|= 0.0167
  HOMO = 0.173703159378049  LUMO = 0.189474414814126
cycle= 48 E= -725.231619635117  delta_E= 3.71e-06  |g|= 0.000778  |ddm|= 0.00786
  HOMO = 0.173679485905148  LUMO = 0.189197525237526
cycle= 49 E= -725.231621946977  delta_E= -2.31e-06  |g|= 0.00177  |ddm|= 0.00947
  HOMO = 0.173680368016876  LUMO = 0.189603778459717
cycle= 50 E= -725.231595395323  delta_E= 2.66e-05  |g|= 0.000901  |ddm|= 0.0588
  HOMO = 0.173679205819781  LUMO = 0.189539852522624
cycle= 51 E= -725.231598305477  delta_E= -2.91e-06  |g|= 0.000775  |ddm|= 0.00666
  HOMO = 0.173678863215839  LUMO = 0.189520951591565
cycle= 52 E= -725.231598614438  delta_E= -3.09e-07  |g|= 0.000759  |ddm|= 0.000726
  HOMO = 0.17368290868738  LUMO = 0.189373994552399
cycle= 53 E= -725.231614212943  delta_E= -1.56e-05  |g|= 0.000898  |ddm|= 0.0333
  HOMO = 0.173678971555043  LUMO = 0.189367652900357
cycle= 54 E= -725.231605930823  delta_E= 8.28e-06  |g|= 0.000908  |ddm|= 0.0175
  HOMO = 0.173679317787188  LUMO = 0.189369079459646
cycle= 55 E= -725.231605627743  delta_E= 3.03e-07  |g|= 0.000903  |ddm|= 0.000711
  HOMO = 0.173672401814483  LUMO = 0.189410095501661
cycle= 56 E= -725.231624226549  delta_E= -1.86e-05  |g|= 0.000848  |ddm|= 0.0392
  HOMO = 0.173696639226905  LUMO = 0.189415207245684
cycle= 57 E= -725.231624857558  delta_E= -6.31e-07  |g|= 0.0008  |ddm|= 0.00156
  HOMO = 0.173674327908162  LUMO = 0.189416584443577
cycle= 58 E= -725.231629434036  delta_E= -4.58e-06  |g|= 0.000825  |ddm|= 0.00883
  HOMO = 0.173669285375511  LUMO = 0.189437347431436
cycle= 59 E= -725.231629363227  delta_E= 7.08e-08  |g|= 0.000791  |ddm|= 0.00141
  HOMO = 0.173668778869541  LUMO = 0.189421383899735
cycle= 60 E= -725.231627693152  delta_E= 1.67e-06  |g|= 0.000828  |ddm|= 0.00326
  HOMO = 0.173649574204471  LUMO = 0.189426584340352
cycle= 61 E= -725.231598555641  delta_E= 2.91e-05  |g|= 0.000904  |ddm|= 0.0576
  HOMO = 0.173627706192783  LUMO = 0.189570878691684
cycle= 62 E= -725.231581962146  delta_E= 1.66e-05  |g|= 0.000815  |ddm|= 0.0353
  HOMO = 0.173605978730355  LUMO = 0.189435695254221
cycle= 63 E= -725.231589067646  delta_E= -7.11e-06  |g|= 0.00107  |ddm|= 0.0208
  HOMO = 0.173600551001704  LUMO = 0.189553021162465
cycle= 64 E= -725.231578597347  delta_E= 1.05e-05  |g|= 0.000782  |ddm|= 0.0258
  HOMO = 0.173610047975586  LUMO = 0.189525039202454
cycle= 65 E= -725.231577523205  delta_E= 1.07e-06  |g|= 0.000761  |ddm|= 0.00425
  HOMO = 0.173641975078009  LUMO = 0.189385689698678
cycle= 66 E= -725.23158412257  delta_E= -6.6e-06  |g|= 0.0011  |ddm|= 0.0164
  HOMO = 0.173580090139338  LUMO = 0.189669555468823
cycle= 67 E= -725.231557015119  delta_E= 2.71e-05  |g|= 0.000785  |ddm|= 0.0718
  HOMO = 0.173576074577333  LUMO = 0.18972725204142
cycle= 68 E= -725.23155170824  delta_E= 5.31e-06  |g|= 0.000924  |ddm|= 0.0167
  HOMO = 0.173581152029749  LUMO = 0.189536768711991
cycle= 69 E= -725.231556486582  delta_E= -4.78e-06  |g|= 0.000738  |ddm|= 0.0149
  HOMO = 0.173600647136549  LUMO = 0.18947653282643
cycle= 70 E= -725.231555487334  delta_E= 9.99e-07  |g|= 0.000787  |ddm|= 0.00723
  HOMO = 0.173600964074566  LUMO = 0.189572179385658
cycle= 71 E= -725.231550642071  delta_E= 4.85e-06  |g|= 0.000722  |ddm|= 0.0215
  HOMO = 0.173611849506226  LUMO = 0.189332359948684
cycle= 72 E= -725.231556608955  delta_E= -5.97e-06  |g|= 0.00107  |ddm|= 0.0244
  HOMO = 0.17360307253087  LUMO = 0.189418437503924
cycle= 73 E= -725.231549869419  delta_E= 6.74e-06  |g|= 0.00076  |ddm|= 0.028
  HOMO = 0.173607910064097  LUMO = 0.189383968927354
cycle= 74 E= -725.231551552897  delta_E= -1.68e-06  |g|= 0.000827  |ddm|= 0.00619
  HOMO = 0.173609377664241  LUMO = 0.189392390972664
cycle= 75 E= -725.231551162857  delta_E= 3.9e-07  |g|= 0.00078  |ddm|= 0.00235
  HOMO = 0.17359891889235  LUMO = 0.189394536605017
cycle= 76 E= -725.231551260378  delta_E= -9.75e-08  |g|= 0.000846  |ddm|= 0.00307
  HOMO = 0.173608360944695  LUMO = 0.189391917582789
cycle= 77 E= -725.231554660241  delta_E= -3.4e-06  |g|= 0.000934  |ddm|= 0.0143
  HOMO = 0.173611820977979  LUMO = 0.189380368528711
cycle= 78 E= -725.231556609706  delta_E= -1.95e-06  |g|= 0.000886  |ddm|= 0.00493
  HOMO = 0.173613136308389  LUMO = 0.189393248481691
cycle= 79 E= -725.231548751474  delta_E= 7.86e-06  |g|= 0.000809  |ddm|= 0.0319
  HOMO = 0.173604217087791  LUMO = 0.189594036868702
cycle= 80 E= -725.231539122736  delta_E= 9.63e-06  |g|= 0.000993  |ddm|= 0.0526
  HOMO = 0.173618608713208  LUMO = 0.189382188224615
cycle= 81 E= -725.231544853664  delta_E= -5.73e-06  |g|= 0.000811  |ddm|= 0.0321
  HOMO = 0.173615665123106  LUMO = 0.189342718096306
cycle= 82 E= -725.231545152637  delta_E= -2.99e-07  |g|= 0.00084  |ddm|= 0.0014
  HOMO = 0.173615473183073  LUMO = 0.189336187000714
cycle= 83 E= -725.231545319218  delta_E= -1.67e-07  |g|= 0.00087  |ddm|= 0.00123
  HOMO = 0.17361348132417  LUMO = 0.18930340467394
cycle= 84 E= -725.231546897215  delta_E= -1.58e-06  |g|= 0.00101  |ddm|= 0.00947
  HOMO = 0.173595088061191  LUMO = 0.189343668005396
cycle= 85 E= -725.231550827011  delta_E= -3.93e-06  |g|= 0.00105  |ddm|= 0.0282
  HOMO = 0.173529079356521  LUMO = 0.189422192316293
cycle= 86 E= -725.231536324857  delta_E= 1.45e-05  |g|= 0.000949  |ddm|= 0.0498
  HOMO = 0.17357231812233  LUMO = 0.189346499866103
cycle= 87 E= -725.231549588143  delta_E= -1.33e-05  |g|= 0.00102  |ddm|= 0.052
  HOMO = 0.173537423593912  LUMO = 0.189307929539408
cycle= 88 E= -725.231541421276  delta_E= 8.17e-06  |g|= 0.00114  |ddm|= 0.0263
  HOMO = 0.173485094016266  LUMO = 0.189732612294502
cycle= 89 E= -725.231524932175  delta_E= 1.65e-05  |g|= 0.00103  |ddm|= 0.0928
  HOMO = 0.173494226390934  LUMO = 0.189512994058473
cycle= 90 E= -725.231527937045  delta_E= -3e-06  |g|= 0.000488  |ddm|= 0.022
  HOMO = 0.173493214707313  LUMO = 0.189437260911346
cycle= 91 E= -725.231527747807  delta_E= 1.89e-07  |g|= 0.000438  |ddm|= 0.00243
  HOMO = 0.173469023564907  LUMO = 0.189788301584943
cycle= 92 E= -725.231522471034  delta_E= 5.28e-06  |g|= 0.00149  |ddm|= 0.0528
  HOMO = 0.173459436004442  LUMO = 0.189520042523857
cycle= 93 E= -725.231524177885  delta_E= -1.71e-06  |g|= 0.000403  |ddm|= 0.0133
  HOMO = 0.17345797025328  LUMO = 0.189512553216477
cycle= 94 E= -725.231523645537  delta_E= 5.32e-07  |g|= 0.000397  |ddm|= 0.0127
  HOMO = 0.173460818785746  LUMO = 0.189387877929226
cycle= 95 E= -725.231523732827  delta_E= -8.73e-08  |g|= 0.00014  |ddm|= 0.00188
  HOMO = 0.173458498354951  LUMO = 0.189399599456901
cycle= 96 E= -725.231523653973  delta_E= 7.89e-08  |g|= 0.000121  |ddm|= 0.00427
  HOMO = 0.173457998508665  LUMO = 0.189395858813067
cycle= 97 E= -725.231523632294  delta_E= 2.17e-08  |g|= 8.24e-05  |ddm|= 0.00121
  HOMO = 0.173461773599658  LUMO = 0.189369425940927
cycle= 98 E= -725.231523660804  delta_E= -2.85e-08  |g|= 0.000116  |ddm|= 0.00331
  HOMO = 0.173466682573723  LUMO = 0.189370961964741
cycle= 99 E= -725.2315235922  delta_E= 6.86e-08  |g|= 6.64e-05  |ddm|= 0.00186
  HOMO = 0.173468594473876  LUMO = 0.189383430657279
cycle= 100 E= -725.231523596303  delta_E= -4.1e-09  |g|= 7.68e-05  |ddm|= 0.000443
SCF not converged.
SCF energy = -725.231523596303




******** <class 'pyscf.soscf.newton_ah.SecondOrderROHF'> ********
method = SecondOrderROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.2000000000000015.chk
max_memory 500000 MB (current use 26941 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f457c0ecc70>
number of electrons per cell  alpha = 48 beta = 48
******** <class 'pyscf.pbc.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-10
conv_tol_grad = None
max. SCF cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.2000000000000015.chk
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 500000 MB (current use 26941 MB)
Set conv_tol_grad to 1e-05


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
  HOMO = 0.173468200723152  LUMO = 0.189381328232608
Initial guess E= -725.231523596303  |g|= 7.68147e-05
macro= 0  E= -725.231523538504  delta_E= 5.7799e-08  |g|= 7.68147e-05  1 KF 11 JK
macro= 1  E= -725.231523378075  delta_E= 1.60429e-07  |g|= 1.36211e-05  2 KF 13 JK
macro= 2  E= -725.231523377071  delta_E= 1.00408e-09  |g|= 1.91896e-05  1 KF 7 JK
macro= 3  E= -725.23152337707  delta_E= 4.54747e-13  |g|= 2.81553e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-725.23152337707  |g|= 2.81553e-06  total 6 KF 38 JK
converged SCF energy = -725.23152337707


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 4.170993e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 2.646164e-07 ; sigma = 6.693910e-07 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 6.673797e-10 ; sigma = 2.273737e-13 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 2 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 3.318067e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 1.738700e-04 ; sigma = 4.980202e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 2.652498e-06 ; sigma = 3.079881e-06 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 9.722826e-07 ; sigma = 1.113165e-09 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.169221e-06 ; sigma = 2.444267e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 4.170993e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 1.614550e-04 ; sigma = 4.981996e-02 ; 1/2 fragment CI solvers converged
Cycle 2: max grad = 2.127072e-06 ; sigma = 3.035576e-06 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 2.559541e-06 ; sigma = 6.266987e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 3 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 7.111328e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 2.538906e-04 ; sigma = 7.078854e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 1.184732e-06 ; sigma = 6.820590e-06 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 2.669463e-08 ; sigma = 6.312462e-10 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.212463e-10 ; sigma = 2.842171e-14 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 7.215329e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 2.370204e-04 ; sigma = 6.917592e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 1.131324e-06 ; sigma = 6.864601e-06 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 2.546006e-08 ; sigma = 6.348415e-10 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.156769e-10 ; sigma = 1.421085e-13 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
LASCI state-average energy = -725.318329720864
LASCI state 0 energy = -725.584208854024
LASCI state 1 energy = -725.165606395988
LASCI state 2 energy = -725.165597105449
LASCI state 3 energy = -725.338114976034
LASCI state 4 energy = -725.338121272824
******** LAS space tables ********
LAS space 0: (16e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.584208854024
S^2 = 0.0000000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 1: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.165606395988
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+7e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 2: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.165597105449
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+7e,10o)     2    A        1
LAS space 3: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.338114976034
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (9e+8e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 4: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.338121272824
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (9e+8e,10o)     2    A        1
LASSI op_o0 memory check: 1709.058096 MB needed of 473084.471296 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Symmetry analysis of 5 LAS rootspaces:
 ix            Energy  <S**2>  Neleca  Nelecb  Nelec   Wfnsym
  0   -725.5842088540   0.000      16      16      32       A
  1   -725.1656063960   0.750      16      15      31       A
  2   -725.1655971054   0.750      16      15      31       A
  3   -725.3381149760   0.750      17      16      33       A
  4   -725.3381212728   0.750      17      16      33       A
Build + diag H matrix LASSI symmetry block 0
['neleca', 'nelecb', 'irrep'] = (17, 16, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 123.54336 MB needed of 473029.60128 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 1
['neleca', 'nelecb', 'irrep'] = (16, 15, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 1652.196096 MB needed of 473029.60128 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 2
['neleca', 'nelecb', 'irrep'] = (16, 16, 0)
(1 rootspaces; 1 states)
LASSI eigenvalues (5 total):
 ix            Energy  <S**2>  Neleca  Nelecb  Wfnsym
  0   -725.5842088540   0.000      16      16       A
  1   -725.3381212728   0.750      17      16       A
  2   -725.3381149760   0.750      17      16       A
  3   -725.1660199126   0.750      16      15       A
  4   -725.1651835889   0.750      16      15       A
Building tPBE functional
Building tPBE functional
Periodic OT-FNAL class is used
LASSI op_o0 memory check: 1709.058096 MB needed of 473029.60128 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 0 E = -740.2244295622006, Eot(tPBE) = -81.11616812824246


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 1 E = -740.1744985878528, Eot(tPBE) = -82.14609054272744


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 2 E = -740.1744913400486, Eot(tPBE) = -82.14608917482344


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 3 E = -739.8083960176008, Eot(tPBE) = -80.0434058249631


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 57] (47937 PWs)
ke_cutoff = 17.63343297227986
omega = 0.45470666109400787
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 4 E = -739.8078535309901, Eot(tPBE) = -80.04388240615329

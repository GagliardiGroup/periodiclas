Discarded 16 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /project/lgagliardi/jangidbhavnesh/Re/Final/MottTransition/NewGeometry/NiO.py ****
import os, sys
import shutil
import numpy as np
import scipy.linalg as la
from pyscf.pbc import scf, gto, df, dft, tools
from pyscf.tools import molden
from pyscf import mcpdft, lib, mcscf
from pyscf.mcscf import avas,project_init_guess
from pyscf import mcscf, dmrgscf
from functools import reduce
from pyscf import __config__
from pyscf.pbc.tools import k2gamma
# Import mcpdft from mrh
from mrh.my_pyscf import mcpdft
from pyscf.tools import molden
pre_orth_method = getattr(__config__, 'pbc_scf_analyze_pre_orth_method', 'ANO')

def getCell(nd=2.085, spin=0, maxMem=200000, basis='def2SVP', pseudo=None):
    cell = gto.Cell()
    cell.a = [[2*nd, nd, nd], [nd, 2*nd, nd], [2*nd, 2*nd, 4*nd]]
    cell.atom= f'''
Ni 0 0 0
Ni {2*nd} {2*nd} {2*nd}
Ni {nd} {nd} {2*nd}
Ni {3*nd} {3*nd} {4*nd}
O {nd} {nd} {nd}
O {3*nd} {3*nd} {3*nd}
O {2*nd} {2*nd} {3*nd}
O {4*nd} {4*nd} {5*nd}
    '''
    cell.basis = basis
    cell.pseudo = pseudo
    cell.output=f'NiO_{nd}.log'
    cell.verbose=lib.logger.INFO
    cell.precision=1e-12
    cell.exp_to_discard=0.1
    cell.spin=0
    cell.max_memory = maxMem
    cell.build()
    return cell

def get_gdf(cell, filename, restart=True):
    if not os.path.exists(filename) or restart:
        gdf = df.GDF(cell)
        gdf._cderi_to_save = filename
        gdf.build()
    return filename

def initguess(mol, mf, ao_label: list, activespacesize:int):
    '''
    Based on the ao_label find the orb which has
    highest character of that ao
    '''
    from pyscf.lo import orth
    baslst = mol.search_ao_label(ao_label)
    assert len(baslst) >=activespacesize
    orbindex=[]
    if len(mf.mo_coeff) > 1:
        mo_coeff = mf.mo_coeff[0]
    else:
        mo_coeff = mf.mo_coeff
    
    nkpts, nao = 1, mf.mo_coeff.shape[1]
    s_sc = mf.get_ovlp()
    orth_coeff = orth.orth_ao(mol, 'meta_lowdin',pre_orth_ao=None, s=s_sc)
    C = reduce(np.dot,(orth_coeff.T.conj(), s_sc, mf.mo_coeff))
    for orb in baslst:
        ao = C[orb]
        A = np.argsort(ao*ao.conj())[-activespacesize:][::-1]
        for element in A:
            if element not in orbindex:
                orbindex.append(element)
                break
    orbind = [x+1 for x in orbindex]
    return sorted(orbind[:activespacesize])

def runSCF(cell,nd=2.085, Restricted=True, Unrestricted=False):
    '''
    Run the Hartree Fock
    '''
    if Restricted:
        kmf = scf.ROHF(cell).density_fit()
    elif Unrestricted:
        kmf = scf.UHF(cell).density_fit()
    else:
        raise NotImplementedError

    kmf.max_cycle=100
    kmf.chkfile = f'NiO_{nd}.chk'
    kmf.init_guess='chk'
    kmf.with_df._cderi = get_gdf(cell, kmf.chkfile.rstrip('.chk')+'.h5', restart=False)
    kmf.exxdiv = None
    kmf.conv_tol = 1e-10
    kmf.kernel()

    if not kmf.converged:
        kmf.newton().run()

    assert kmf, "mean-field didn't converge"
    return kmf

def getfrags(nfrags: int):
    '''
    If NiO is in POSCAR Format where first N-atoms are Ni and
    next N-atoms are O, then get the frag atom no
    '''
    assert nfrags>=1, "You should know what you are doing"
    frags = []
    offset = nfrags * 2
    for i in range(nfrags):
        frag = [i * 2, i * 2 + offset, i * 2 + 1, i * 2 + offset + 1]
        frags.append(frag)
    return frags

def runLASSCF(cell, kmf):
    nfrags = 2
    ncas = 10 
    nelec = 16
    norb  = tuple([ncas,]*nfrags)
    nele  = tuple([nelec,]*nfrags)
    nspin = tuple([1,]*nfrags)

    orblst = initguess(cell, kmf, ao_label=['Ni 3d', ], activespacesize=sum(norb))

    frags = getfrags(nfrags)
    from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
    las = LASSCF(kmf, norb, nele, spin_sub=nspin)
    sortedmo = las.sort_mo(orblst, kmf.mo_coeff)
    mo0 = las.localize_init_guess(frags, sortedmo)
    #mo0 = sortedmo
    molden.from_mo(cell, f'NiO.{nfrags}.las.molden', mo0[:, las.ncore:las.ncore+(ncas*nfrags)])
    las_weights,las_charges,las_spins,las_smults=genModelSpace(nfrags)
    las = las.state_average(las_weights,las_charges,las_spins,las_smults)
    elasci = las.lasci_(mo0)
    las.mo_coeff = mo0
    return las

# Model Space for the band gap
def genModelSpace(nfrags):
    las_charges = []
    las_spins = [] #2s
    las_smults = [] #2s+1

    las_charges += [[0]*nfrags]
    las_spins += [[0]*nfrags]
    las_smults += [[las_spins[0][0]+1]*nfrags]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(-idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    nrootspaces = len(las_charges)
    las_weights = np.ones(nrootspaces)/nrootspaces
    return las_weights,las_charges,las_spins,las_smults

def processlas(las):
    from periodiclas.tools import sign_control, util
    las.ci = sign_control.fix_sign(las)
    las.dump_spaces()
    return las

def runLASSI(las):
    from mrh.my_pyscf.lassi import lassi
    lsi = lassi.LASSI(las)
    energies_lassi, civecs_lassi = lsi.kernel()
    return lsi, energies_lassi

def runLASSIPDFT(lsi, states=[0]):
    from mrh.my_pyscf import mcpdft
    mc = mcpdft.LASSI(lsi, 'tPBE', states=states)
    energies = mc.kernel()[0]
    return energies

def getBANDGAP(nele, lsi, energies_lassi):
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [list(x) for x in stateidx]
    ip = 27.21139*(min(energies_lassi[stateidx[1]]) - min(energies_lassi[stateidx[0]]))
    ea = 27.21139*(min(energies_lassi[stateidx[0]]) - min(energies_lassi[stateidx[2]]))
    return ip, ea

def getNatorbOcc(nele, lsi):
    from mrh.my_pyscf.lassi.lassi import root_make_rdm12s
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [int(list(x)[0]) for x in stateidx]
    for state in stateidx:
        natorb_casdm1 = root_make_rdm12s (lsi, lsi.ci, lsi.si, state=state, opt=lsi.opt)[0].sum (0)
        mo_occ = lsi._las.canonicalize (natorb_casdm1=natorb_casdm1)[2]
        mo_occ = [x for x in mo_occ if 0 < x < 2]
        print("State-",state, mo_occ)

def savepickel(mf, lsi, pdftenergy=0, R=2.47):
    """
    Save the LAS Band Structure Data
    """

    from periodiclas.tools import sign_control, util
    civec = lsi.get_sivec_vacuum_shuffle(state=0)
    charges = util.las_charges(lsi._las)

    data = {"energies_lassi":lsi.e_roots,
            "energies_lassipdft":pdftenergy,
            "civecs":civec,
            "charges":charges,
            "dist":R,
            "mf_coeff":mf.mo_coeff,
            "mf_occ":mf.mo_occ,
            "mf_ene":mf.mo_energy}


if __name__ == "__main__":
    nd = 2.085
    for nd in [1.7, 2.1, 2.3, 2.7, 3.1, 3.5, 3.9]:
        cell =  getCell(nd, maxMem=500000, basis='gth-dzvp-molopt-sr', pseudo='gth-pade')
        kmf = runSCF(cell, nd, Restricted=True, Unrestricted=False)

        #molden.from_mo(cell, f'NiO_{nU}.molden', kmf.mo_coeff)
        las = runLASSCF(cell, kmf)
        las = processlas(las)

        lsi,energies_lassi = runLASSI(las)
        IP_LASSI, EA_LASSI = getBANDGAP(32, lsi,energies_lassi)
        energies_mcpdft = runLASSIPDFT(lsi, states=[x for x in range(len(energies_lassi))])
        IP_PDFT, EA_PDFT = getBANDGAP(32, lsi,np.asarray(energies_mcpdft))
        
        savepickel(kmf, lsi, pdftenergy=energies_mcpdft, R=nd)

        print("Results: LASSI ", )
        print("Ionization Energy: ", IP_LASSI)
        print("ElectAtt   Energy: ", EA_LASSI)
        print("Band Gap: ", IP_LASSI-EA_LASSI)

        print("Results: PDFT", )
        print("Ionization Energy: ", IP_PDFT)
        print("ElectAtt   Energy: ", EA_PDFT)
        print("Band Gap: ", IP_PDFT-EA_PDFT)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0555.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 128
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.26.2  scipy 1.11.4  h5py 3.10.0
Date: Fri Mar 14 23:38:25 2025
PySCF version 2.8.0
PySCF path  /home/jangidbhavnesh/bin/pyscf
GIT ORIG_HEAD a0665c4a7bf54e33f01295b3eea390be7a17d76d
GIT HEAD (branch master) 6f6d3741bf42543e02ccaa1d4ef43d9bf83b3dda
mrh path  /home/jangidbhavnesh/bin/mrh
GIT ORIG_HEAD ed1f605b415d72e71fb56d97b9d163809b62b172
GIT HEAD (branch master) ea89791c15c26abd3b0f0efdeadd7a286ca4585a

[ENV] PYSCF_EXT_PATH /home/jangidbhavnesh/bin/pyscf:/home/jangidbhavnesh/bin/pyscf-forge:/home/jangidbhavnesh/bin/dmrgscf:/home/jangidbhavnesh/bin:
[CONFIG] conf_file /home/jangidbhavnesh/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 8
[INPUT] num. electrons = 96
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ni     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Ni     7.000000000000   7.000000000000   7.000000000000 AA   13.228082871955  13.228082871955  13.228082871955 Bohr   0.0
[INPUT]  3 Ni     3.500000000000   3.500000000000   7.000000000000 AA    6.614041435978   6.614041435978  13.228082871955 Bohr   0.0
[INPUT]  4 Ni    10.500000000000  10.500000000000  14.000000000000 AA   19.842124307933  19.842124307933  26.456165743911 Bohr   0.0
[INPUT]  5 O      3.500000000000   3.500000000000   3.500000000000 AA    6.614041435978   6.614041435978   6.614041435978 Bohr   0.0
[INPUT]  6 O     10.500000000000  10.500000000000  10.500000000000 AA   19.842124307933  19.842124307933  19.842124307933 Bohr   0.0
[INPUT]  7 O      7.000000000000   7.000000000000  10.500000000000 AA   13.228082871955  13.228082871955  19.842124307933 Bohr   0.0
[INPUT]  8 O     14.000000000000  14.000000000000  17.500000000000 AA   26.456165743911  26.456165743911  33.070207179889 Bohr   0.0

nuclear repulsion = -285.140737030963
number of shells = 28
number of NR pGTOs = 500
number of NR cGTOs = 156
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:    117646.81
lattice vectors  a1 [13.228082872, 6.614041436, 6.614041436]
                 a2 [6.614041436, 13.228082872, 6.614041436]
                 a3 [13.228082872, 13.228082872, 26.456165744]
dimension = 3
low_dim_ft_type = None
Cell volume = 2314.68
exp_to_discard = 0.1
rcut = 21.840927745318478 (nimgs = [3 3 2])
lattice sum = 1233 cells
precision = 1e-12
pseudo = gth-pade
ke_cutoff = 1563.543132532536
    = [291 291 579] mesh (49030299 PWs)


******** <class 'pyscf.pbc.df.df.GDF'> ********
auxbasis = None
exp_to_discard = 0.1
_cderi_to_save = NiO_3.5.h5
len(kpts) = 1
ETB for O: l = 0, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 1, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 2, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 3, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 4, exps = 0.32498323008 * 2^n , n = 0..6
ETB for Ni: l = 0, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 1, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 2, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 3, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 4, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 5, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 6, exps = 0.689956484316 * 2^n , n = 0..4

WARN: Even tempered Gaussians are generated as DF auxbasis for  O Ni

Drop 0 primitive fitting functions
make aux basis, num shells = 280, num cGTOs = 1680
auxcell.rcut 14.405988831603228


******** <class 'pyscf.pbc.df.rsdf_builder._RSGDFBuilder'> ********
mesh = [19 19 35] (12635 PWs)
ke_cutoff = 5.433535631075199
omega = 0.2472086990894628
exclude_d_aux = True
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.scf.rohf.ROHF'> ********
method = ROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.5.chk
max_memory 500000 MB (current use 9873 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f240854d0a0>
number of electrons per cell  alpha = 48 beta = 48
Set gradient conv threshold to 1e-05

WARN: Fail in reading NiO_3.5.chk. Use MINAO initial guess



******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
init E= -723.460323577751

WARN: HOMO 0.483273465624843 >= LUMO 0.48334539580665

cycle= 1 E= -716.246481535436  delta_E= 7.21  |g|= 8.64  |ddm|= 4.56

WARN: HOMO 0.283424397240237 >= LUMO 0.283575254053898

cycle= 2 E= -675.804255427536  delta_E= 40.4  |g|=   11  |ddm|= 10.2
  HOMO = 0.268253311248534  LUMO = 0.486882778274254
cycle= 3 E= -720.569349939522  delta_E= -44.8  |g|= 5.24  |ddm|= 9.73
  HOMO = 0.0761092132910748  LUMO = 0.414999717897987
cycle= 4 E= -724.034508468608  delta_E= -3.47  |g|=  3.3  |ddm|= 1.93
  HOMO = 0.0538455517888788  LUMO = 0.170290097648417
cycle= 5 E= -725.420377013364  delta_E= -1.39  |g|= 1.05  |ddm|= 1.26

WARN: HOMO 0.140244143401947 >= LUMO 0.140244143401966

cycle= 6 E= -722.255320259533  delta_E= 3.17  |g|= 4.04  |ddm|= 4.14
  HOMO = 0.128845118650311  LUMO = 0.133159805977011
cycle= 7 E= -722.586410952268  delta_E= -0.331  |g|= 3.79  |ddm|= 1.51

WARN: HOMO 0.129344900437886 >= LUMO 0.130178421138184

cycle= 8 E= -722.593140053682  delta_E= -0.00673  |g|= 3.77  |ddm|= 0.367
  HOMO = 0.128759320298254  LUMO = 0.130841045707787
cycle= 9 E= -722.472471378596  delta_E= 0.121  |g|=  3.8  |ddm|= 0.548
  HOMO = 0.12777929587346  LUMO = 0.12883059337125
cycle= 10 E= -720.629984892224  delta_E= 1.84  |g|= 4.07  |ddm|= 1.56
  HOMO = 0.127118889250003  LUMO = 0.128808952768359
cycle= 11 E= -720.442552274717  delta_E= 0.187  |g|= 4.06  |ddm|= 0.152
  HOMO = 0.128602716745977  LUMO = 0.154341794533074
cycle= 12 E= -720.517183306694  delta_E= -0.0746  |g|= 3.51  |ddm|= 0.749
  HOMO = 0.121133316211481  LUMO = 0.128148765570269
cycle= 13 E= -724.279220899155  delta_E= -3.76  |g|= 2.99  |ddm|= 2.23
  HOMO = 0.184020396556064  LUMO = 0.236183051637276
cycle= 14 E= -721.318154237847  delta_E= 2.96  |g|= 5.18  |ddm|= 4.83
  HOMO = 0.0991019435832019  LUMO = 0.150392594324061
cycle= 15 E= -724.468066960239  delta_E= -3.15  |g|= 2.78  |ddm|= 1.71
  HOMO = 0.111789387861109  LUMO = 0.116183586330489
cycle= 16 E= -725.551945299273  delta_E= -1.08  |g|= 0.953  |ddm|= 1.56
  HOMO = 0.123442031742526  LUMO = 0.124894219391288
cycle= 17 E= -724.444376244731  delta_E= 1.11  |g|= 2.43  |ddm|=  2.8
  HOMO = 0.12756967137427  LUMO = 0.140526618035592
cycle= 18 E= -724.327897605097  delta_E= 0.116  |g|= 2.98  |ddm|= 2.74
  HOMO = 0.130699810584257  LUMO = 0.144552173754999
cycle= 19 E= -724.413940960432  delta_E= -0.086  |g|= 2.88  |ddm|= 0.0986
  HOMO = 0.133215942148537  LUMO = 0.147440588898219
cycle= 20 E= -724.514823174367  delta_E= -0.101  |g|= 2.77  |ddm|= 0.11
  HOMO = 0.116217397199293  LUMO = 0.138733967109619
cycle= 21 E= -724.258904188877  delta_E= 0.256  |g|= 2.45  |ddm|= 2.73
  HOMO = 0.125103768881641  LUMO = 0.145156362392982
cycle= 22 E= -724.511009740404  delta_E= -0.252  |g|= 2.78  |ddm|= 2.75
  HOMO = 0.131429602017965  LUMO = 0.14313018280333
cycle= 23 E= -724.697507066489  delta_E= -0.186  |g|= 2.57  |ddm|= 0.244
  HOMO = 0.131589938621562  LUMO = 0.141162895180836
cycle= 24 E= -724.796783164989  delta_E= -0.0993  |g|= 2.45  |ddm|= 0.242

WARN: HOMO 0.183281810942336 >= LUMO 0.183432522362276

cycle= 25 E= -717.118034851796  delta_E= 7.68  |g|= 5.98  |ddm|= 3.86
  HOMO = 0.13983077361555  LUMO = 0.148801056489898
cycle= 26 E= -723.51207869255  delta_E= -6.39  |g|= 3.33  |ddm|= 3.33
  HOMO = 0.131520224908336  LUMO = 0.13869641618957
cycle= 27 E= -724.374461246961  delta_E= -0.862  |g|= 2.42  |ddm|= 2.39
  HOMO = 0.126395458999149  LUMO = 0.131339767254512
cycle= 28 E= -724.289628136819  delta_E= 0.0848  |g|= 2.62  |ddm|= 3.23
  HOMO = 0.115227367107367  LUMO = 0.137139731422553
cycle= 29 E= -724.052180792602  delta_E= 0.237  |g|= 2.73  |ddm|= 3.08
  HOMO = 0.158553730314213  LUMO = 0.174418734447555
cycle= 30 E= -724.061760035716  delta_E= -0.00958  |g|= 2.71  |ddm|= 3.29
  HOMO = 0.138193036300816  LUMO = 0.142064382452926
cycle= 31 E= -724.844963463148  delta_E= -0.783  |g|= 2.09  |ddm|= 2.84
  HOMO = 0.140204355077562  LUMO = 0.141366381469822
cycle= 32 E= -724.848017459573  delta_E= -0.00305  |g|= 1.99  |ddm|= 2.51
  HOMO = 0.128559069902301  LUMO = 0.136182875812638
cycle= 33 E= -724.722043456976  delta_E= 0.126  |g|= 2.29  |ddm|= 2.68
  HOMO = 0.124786599180209  LUMO = 0.12592372126129
cycle= 34 E= -723.998499304325  delta_E= 0.724  |g|= 2.64  |ddm|=  3.3
  HOMO = 0.129533944527139  LUMO = 0.140302566309549
cycle= 35 E= -724.260511454764  delta_E= -0.262  |g|= 2.41  |ddm|= 2.74
  HOMO = 0.156072125953242  LUMO = 0.175419440943846
cycle= 36 E= -723.902707779262  delta_E= 0.358  |g|= 2.96  |ddm|=  3.6
  HOMO = 0.137161436445243  LUMO = 0.140076021998715
cycle= 37 E= -724.699214894096  delta_E= -0.797  |g|= 1.92  |ddm|=  2.7
  HOMO = 0.135148369857962  LUMO = 0.138105078089458
cycle= 38 E= -724.833388607914  delta_E= -0.134  |g|= 1.91  |ddm|=  2.8
  HOMO = 0.126767241936032  LUMO = 0.143383439025878
cycle= 39 E= -724.515613058403  delta_E= 0.318  |g|= 2.22  |ddm|= 2.64
  HOMO = 0.134559612853153  LUMO = 0.142973102609591
cycle= 40 E= -724.406517092331  delta_E= 0.109  |g|= 2.37  |ddm|= 3.46
  HOMO = 0.134981104741437  LUMO = 0.137546424562793
cycle= 41 E= -725.122637055129  delta_E= -0.716  |g|= 1.74  |ddm|= 2.46
  HOMO = 0.132039701503347  LUMO = 0.141297339339699
cycle= 42 E= -724.529964667653  delta_E= 0.593  |g|= 2.39  |ddm|= 2.71
  HOMO = 0.140455109739814  LUMO = 0.144326407065146
cycle= 43 E= -724.5986705702  delta_E= -0.0687  |g|= 2.22  |ddm|= 2.58
  HOMO = 0.136603818072383  LUMO = 0.143549414011421
cycle= 44 E= -724.413170609366  delta_E= 0.185  |g|= 2.26  |ddm|= 2.95
  HOMO = 0.138637986283581  LUMO = 0.140490095457778
cycle= 45 E= -725.114301419646  delta_E= -0.701  |g|= 1.62  |ddm|= 2.22
  HOMO = 0.135993242167642  LUMO = 0.141807999885325
cycle= 46 E= -724.224761004439  delta_E= 0.89  |g|= 2.46  |ddm|= 3.05
  HOMO = 0.125493229303475  LUMO = 0.148308762732713
cycle= 47 E= -724.036228386303  delta_E= 0.189  |g|= 2.67  |ddm|= 2.84
  HOMO = 0.140893956775591  LUMO = 0.146864625343838
cycle= 48 E= -724.511621449563  delta_E= -0.475  |g|= 2.38  |ddm|= 2.46
  HOMO = 0.138013456754897  LUMO = 0.143746936993684
cycle= 49 E= -724.9523057204  delta_E= -0.441  |g|= 1.63  |ddm|= 2.33
  HOMO = 0.125326566789746  LUMO = 0.136998272528814
cycle= 50 E= -724.916291455947  delta_E= 0.036  |g|= 1.86  |ddm|= 2.32

WARN: HOMO 0.140514346385497 >= LUMO 0.1414145802762

cycle= 51 E= -725.364144819576  delta_E= -0.448  |g|= 1.27  |ddm|= 2.77
  HOMO = 0.140740998109009  LUMO = 0.142365109799921
cycle= 52 E= -725.000673344694  delta_E= 0.363  |g|=  1.8  |ddm|= 3.09
  HOMO = 0.137639424768209  LUMO = 0.141543539795815
cycle= 53 E= -724.467693422096  delta_E= 0.533  |g|= 2.29  |ddm|= 2.92
  HOMO = 0.137416425966702  LUMO = 0.139398095726695
cycle= 54 E= -725.425494128081  delta_E= -0.958  |g|= 1.07  |ddm|= 2.53
  HOMO = 0.137983406465101  LUMO = 0.141450206057614
cycle= 55 E= -725.402496840976  delta_E= 0.023  |g|=  1.2  |ddm|= 1.62
  HOMO = 0.137547469554297  LUMO = 0.139954502926682
cycle= 56 E= -724.938340219597  delta_E= 0.464  |g|=  1.7  |ddm|= 2.83
  HOMO = 0.135267680879121  LUMO = 0.137747304939905
cycle= 57 E= -725.018018118644  delta_E= -0.0797  |g|=  1.7  |ddm|= 2.67
  HOMO = 0.138286198771208  LUMO = 0.140362625821702
cycle= 58 E= -725.195241272171  delta_E= -0.177  |g|= 1.63  |ddm|= 2.43
  HOMO = 0.136953760801038  LUMO = 0.140876556831797
cycle= 59 E= -724.734839753604  delta_E= 0.46  |g|= 2.06  |ddm|= 3.04
  HOMO = 0.127844996022284  LUMO = 0.150046524463811
cycle= 60 E= -724.552007089352  delta_E= 0.183  |g|= 2.37  |ddm|=  2.5
  HOMO = 0.139721448678375  LUMO = 0.143386413705456
cycle= 61 E= -725.146588948585  delta_E= -0.595  |g|= 1.51  |ddm|= 2.85
  HOMO = 0.141377189761148  LUMO = 0.144391178663991
cycle= 62 E= -724.772010824735  delta_E= 0.375  |g|= 2.04  |ddm|= 2.54

WARN: HOMO 0.138479583399349 >= LUMO 0.139313555764406

cycle= 63 E= -725.438321294007  delta_E= -0.666  |g|= 1.09  |ddm|= 2.54
  HOMO = 0.133779898228655  LUMO = 0.145915246712043
cycle= 64 E= -724.740743634653  delta_E= 0.698  |g|= 1.89  |ddm|=  3.1
  HOMO = 0.126355196377629  LUMO = 0.139238932275317
cycle= 65 E= -724.22470565141  delta_E= 0.516  |g|= 2.59  |ddm|=  2.8
  HOMO = 0.133561516219308  LUMO = 0.136934896495798
cycle= 66 E= -725.327299200059  delta_E= -1.1  |g|= 1.28  |ddm|= 2.42
  HOMO = 0.124704005600565  LUMO = 0.150957356524854
cycle= 67 E= -724.380689721932  delta_E= 0.947  |g|= 2.58  |ddm|= 3.04
  HOMO = 0.138186850173935  LUMO = 0.142847991212621
cycle= 68 E= -724.644561059997  delta_E= -0.264  |g|= 2.06  |ddm|= 2.98
  HOMO = 0.139257452573921  LUMO = 0.14288309783039
cycle= 69 E= -724.852965420114  delta_E= -0.208  |g|= 1.99  |ddm|=  2.3
  HOMO = 0.139744213463726  LUMO = 0.144085913397945
cycle= 70 E= -724.690987535549  delta_E= 0.162  |g|= 2.08  |ddm|= 2.95
  HOMO = 0.137805736936399  LUMO = 0.141473583319831
cycle= 71 E= -724.947524449509  delta_E= -0.257  |g|= 1.92  |ddm|= 3.15
  HOMO = 0.136910537101646  LUMO = 0.142839543573925
cycle= 72 E= -725.397178667818  delta_E= -0.45  |g|= 1.23  |ddm|= 2.84
  HOMO = 0.128620742284315  LUMO = 0.140262908835204
cycle= 73 E= -724.289296824115  delta_E= 1.11  |g|= 2.36  |ddm|= 2.45
  HOMO = 0.138395965934113  LUMO = 0.140477368735077
cycle= 74 E= -724.599638988059  delta_E= -0.31  |g|= 2.13  |ddm|= 2.75
  HOMO = 0.121098022597225  LUMO = 0.135524191258908
cycle= 75 E= -724.375876384354  delta_E= 0.224  |g|=  2.4  |ddm|= 3.03
  HOMO = 0.132082799467992  LUMO = 0.135610953049114
cycle= 76 E= -725.238788393432  delta_E= -0.863  |g|= 1.39  |ddm|= 2.63
  HOMO = 0.137230276325404  LUMO = 0.141023377103757
cycle= 77 E= -724.646161674246  delta_E= 0.593  |g|= 2.01  |ddm|= 2.73
  HOMO = 0.133237918202421  LUMO = 0.13726391611661
cycle= 78 E= -724.534867704226  delta_E= 0.111  |g|= 2.31  |ddm|= 2.81
  HOMO = 0.143342307287555  LUMO = 0.145650428255957
cycle= 79 E= -724.962915348941  delta_E= -0.428  |g|=  2.2  |ddm|= 2.68
  HOMO = 0.13517974325374  LUMO = 0.137537320251209
cycle= 80 E= -725.360070871561  delta_E= -0.397  |g|= 1.24  |ddm|= 2.76
  HOMO = 0.139574929310974  LUMO = 0.144333569839267
cycle= 81 E= -725.260979149195  delta_E= 0.0991  |g|= 1.49  |ddm|= 3.25
  HOMO = 0.136430397333263  LUMO = 0.142017097205378
cycle= 82 E= -724.836330716701  delta_E= 0.425  |g|= 1.87  |ddm|= 2.78
  HOMO = 0.127971999419614  LUMO = 0.143423614034424
cycle= 83 E= -724.479932853639  delta_E= 0.356  |g|= 2.44  |ddm|= 2.73
  HOMO = 0.137797050690858  LUMO = 0.139414273568691
cycle= 84 E= -725.332903891633  delta_E= -0.853  |g|= 1.29  |ddm|= 1.83
  HOMO = 0.137006868346195  LUMO = 0.141870533407638
cycle= 85 E= -724.694651538253  delta_E= 0.638  |g|= 2.14  |ddm|= 2.91
  HOMO = 0.13484930877317  LUMO = 0.141591457740019
cycle= 86 E= -725.084237317149  delta_E= -0.39  |g|= 1.53  |ddm|=  2.5

WARN: HOMO 0.139926521364929 >= LUMO 0.140836704979709

cycle= 87 E= -725.618120447672  delta_E= -0.534  |g|= 0.809  |ddm|= 2.18
  HOMO = 0.142875218353371  LUMO = 0.157851154332265
cycle= 88 E= -724.332828223422  delta_E= 1.29  |g|= 2.46  |ddm|=    3
  HOMO = 0.129945453536839  LUMO = 0.149206753326935
cycle= 89 E= -724.901510587779  delta_E= -0.569  |g|= 1.84  |ddm|= 2.74
  HOMO = 0.129685446203569  LUMO = 0.144582690598296
cycle= 90 E= -724.501739795985  delta_E=  0.4  |g|= 2.35  |ddm|= 3.02
  HOMO = 0.137109949325582  LUMO = 0.142709456797723
cycle= 91 E= -725.208911815893  delta_E= -0.707  |g|=  1.4  |ddm|= 2.79
  HOMO = 0.137607122447185  LUMO = 0.145023346760975
cycle= 92 E= -725.315135805825  delta_E= -0.106  |g|= 1.28  |ddm|= 2.79
  HOMO = 0.137782786682075  LUMO = 0.141523876644735
cycle= 93 E= -725.203589135812  delta_E= 0.112  |g|= 1.43  |ddm|= 2.48
  HOMO = 0.138424422930862  LUMO = 0.140504688144088
cycle= 94 E= -725.234246400085  delta_E= -0.0307  |g|= 1.26  |ddm|= 3.11
  HOMO = 0.136433450865727  LUMO = 0.141770521015634
cycle= 95 E= -725.439876502094  delta_E= -0.206  |g|= 1.01  |ddm|= 1.87
  HOMO = 0.141041426260197  LUMO = 0.152661370544717
cycle= 96 E= -724.973290729024  delta_E= 0.467  |g|=  1.8  |ddm|= 2.21
  HOMO = 0.141582107592546  LUMO = 0.146324313885917
cycle= 97 E= -725.136104376382  delta_E= -0.163  |g|= 1.63  |ddm|= 3.06
  HOMO = 0.140237832303105  LUMO = 0.142119707698475
cycle= 98 E= -725.472409499125  delta_E= -0.336  |g|= 0.825  |ddm|= 3.24
  HOMO = 0.139563207939781  LUMO = 0.143525800231412
cycle= 99 E= -724.742623016464  delta_E= 0.73  |g|= 2.15  |ddm|= 2.77
  HOMO = 0.139518261189809  LUMO = 0.142065279850846
cycle= 100 E= -725.133486003961  delta_E= -0.391  |g|= 1.61  |ddm|=  2.8
SCF not converged.
SCF energy = -725.133486003961




******** <class 'pyscf.soscf.newton_ah.SecondOrderROHF'> ********
method = SecondOrderROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.5.chk
max_memory 500000 MB (current use 11030 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f240854d0a0>
number of electrons per cell  alpha = 48 beta = 48
******** <class 'pyscf.pbc.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-10
conv_tol_grad = None
max. SCF cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.5.chk
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 500000 MB (current use 11030 MB)
Set conv_tol_grad to 1e-05


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
  HOMO = 0.380214678165735  LUMO = 0.387721762844297
Initial guess E= -725.133486003961  |g|= 1.61104
macro= 0  E= -725.645628737143  delta_E= -0.512143  |g|= 0.789265  3 KF 15 JK
macro= 1  E= -725.709610005263  delta_E= -0.0639813  |g|= 0.510443  3 KF 16 JK
macro= 2  E= -725.765078060551  delta_E= -0.0554681  |g|= 0.221048  3 KF 18 JK
macro= 3  E= -725.76675958319  delta_E= -0.00168152  |g|= 0.162427  3 KF 18 JK
macro= 4  E= -725.761267639367  delta_E= 0.00549194  |g|= 0.183512  3 KF 15 JK
macro= 5  E= -725.782149926143  delta_E= -0.0208823  |g|= 0.185306  3 KF 15 JK
macro= 6  E= -725.790441803747  delta_E= -0.00829188  |g|= 0.131618  3 KF 19 JK
macro= 7  E= -725.806322330339  delta_E= -0.0158805  |g|= 0.152953  4 KF 20 JK
macro= 8  E= -725.820458621505  delta_E= -0.0141363  |g|= 0.0993805  3 KF 19 JK
macro= 9  E= -725.830474273779  delta_E= -0.0100157  |g|= 0.0797244  3 KF 15 JK
macro= 10  E= -725.838084241085  delta_E= -0.00760997  |g|= 0.0528226  4 KF 19 JK
macro= 11  E= -725.843576404989  delta_E= -0.00549216  |g|= 0.0342099  3 KF 14 JK
macro= 12  E= -725.843011268024  delta_E= 0.000565137  |g|= 0.0353478  3 KF 14 JK
macro= 13  E= -725.851736168166  delta_E= -0.0087249  |g|= 0.0304035  3 KF 14 JK
macro= 14  E= -725.858782947563  delta_E= -0.00704678  |g|= 0.0300008  3 KF 15 JK
macro= 15  E= -725.862920072355  delta_E= -0.00413712  |g|= 0.0177589  3 KF 15 JK
macro= 16  E= -725.863636018305  delta_E= -0.000715946  |g|= 0.0116805  3 KF 16 JK
macro= 17  E= -725.863678250568  delta_E= -4.22323e-05  |g|= 5.99794e-05  5 KF 36 JK
macro= 18  E= -725.863678251498  delta_E= -9.29504e-10  |g|= 1.69989e-05  1 KF 11 JK
macro= 19  E= -725.863678251498  delta_E= 1.13687e-13  |g|= 3.23666e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 20  E=-725.863678251498  |g|= 3.23666e-06  total 61 KF 347 JK

WARN: HOMO 0.14426466503204036 > LUMO 0.13933911303089538 was found in the canonicalized orbitals.

converged SCF energy = -725.863678251498


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.731719e-01 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 2.191306e-04 ; sigma = 4.353865e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 9.882739e-06 ; sigma = 4.591209e-06 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 7.211643e-08 ; sigma = 1.271772e-09 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 2.813218e-09 ; sigma = 3.979039e-13 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.856877e-01 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 9.643658e-04 ; sigma = 2.832258e-01 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 1.388126e-05 ; sigma = 8.898976e-05 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 1.558994e-06 ; sigma = 6.580194e-10 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 8.896840e-07 ; sigma = 3.029754e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.685251e-01 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 9.352631e-05 ; sigma = 3.817695e-02 ; 1/2 fragment CI solvers converged
Cycle 2: max grad = 8.416216e-06 ; sigma = 2.310812e-06 ; 1/2 fragment CI solvers converged
Cycle 3: max grad = 1.599703e-06 ; sigma = 3.078188e-07 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.543484e-06 ; sigma = 6.427925e-08 ; 2/2 fragment CI solvers converged
Cycle 5: max grad = 1.428354e-06 ; sigma = 4.777704e-08 ; 2/2 fragment CI solvers converged
Cycle 6: max grad = 1.372331e-06 ; sigma = 3.712458e-08 ; 2/2 fragment CI solvers converged
Cycle 7: max grad = 1.261716e-06 ; sigma = 3.074550e-08 ; 2/2 fragment CI solvers converged
Cycle 8: max grad = 1.121481e-06 ; sigma = 2.613677e-08 ; 2/2 fragment CI solvers converged
Cycle 9: max grad = 9.918044e-07 ; sigma = 2.230040e-08 ; 2/2 fragment CI solvers converged
Cycle 10: max grad = 9.180773e-07 ; sigma = 1.908202e-08 ; 2/2 fragment CI solvers converged
Cycle 11: max grad = 8.650592e-07 ; sigma = 1.634164e-08 ; 2/2 fragment CI solvers converged
Cycle 12: max grad = 7.042644e-07 ; sigma = 9.018208e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 12 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 5.550367e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 6.752570e-04 ; sigma = 2.366498e-01 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 2.170215e-06 ; sigma = 2.218287e-05 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 1.057096e-08 ; sigma = 4.561826e-10 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 7.301558e-11 ; sigma = 5.684342e-14 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.789745e-01 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 3.248765e-04 ; sigma = 5.532268e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 4.902868e-04 ; sigma = 1.074737e-05 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 3.006192e-06 ; sigma = 3.451001e-06 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 3.493587e-07 ; sigma = 2.549143e-09 ; 2/2 fragment CI solvers converged
Cycle 5: max grad = 2.147642e-09 ; sigma = 1.875833e-12 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 5 cycles
LASCI state-average energy = -725.848057587715
LASCI state 0 energy = -725.873553344124
LASCI state 1 energy = -725.750558292637
LASCI state 2 energy = -725.725520914292
LASCI state 3 energy = -725.922999908886
LASCI state 4 energy = -725.967655478635
******** LAS space tables ********
LAS space 0: (16e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.873553344124
S^2 = 0.0000000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 1: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.750558292637
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+7e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 2: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.725520914292
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+7e,10o)     2    A        1
LAS space 3: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.922999908886
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (9e+8e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 4: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.967655478635
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (9e+8e,10o)     2    A        1
LASSI op_o0 memory check: 1709.058096 MB needed of 488976.123904 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Symmetry analysis of 5 LAS rootspaces:
 ix            Energy  <S**2>  Neleca  Nelecb  Nelec   Wfnsym
  0   -725.8735533441   0.000      16      16      32       A
  1   -725.7505582926   0.750      16      15      31       A
  2   -725.7255209143   0.750      16      15      31       A
  3   -725.9229999089   0.750      17      16      33       A
  4   -725.9676554786   0.750      17      16      33       A
Build + diag H matrix LASSI symmetry block 0
['neleca', 'nelecb', 'irrep'] = (17, 16, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 123.54336 MB needed of 488970.942464 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 1
['neleca', 'nelecb', 'irrep'] = (16, 15, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 1652.196096 MB needed of 488970.868736 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 2
['neleca', 'nelecb', 'irrep'] = (16, 16, 0)
(1 rootspaces; 1 states)
LASSI eigenvalues (5 total):
 ix            Energy  <S**2>  Neleca  Nelecb  Wfnsym
  0   -725.9676597535   0.750      17      16       A
  1   -725.9229956340   0.750      17      16       A
  2   -725.8735533441   0.000      16      16       A
  3   -725.7505582926   0.750      16      15       A
  4   -725.7255209143   0.750      16      15       A
Building tPBE functional
Building tPBE functional
Periodic OT-FNAL class is used
LASSI op_o0 memory check: 1709.058096 MB needed of 488965.888 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 0 E = -740.2404517609078, Eot(tPBE) = -82.21767990537215


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 1 E = -740.2076292143138, Eot(tPBE) = -82.08821780465787


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 2 E = -740.084640083367, Eot(tPBE) = -81.13955998458441


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 3 E = -739.82789301626, Eot(tPBE) = -80.27280664662325


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 61] (58621 PWs)
ke_cutoff = 16.921045217881247
omega = 0.44575035560518983
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 4 E = -739.5796345466514, Eot(tPBE) = -79.88921512221086

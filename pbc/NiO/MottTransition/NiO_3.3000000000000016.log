Discarded 16 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /project/lgagliardi/jangidbhavnesh/Re/Final/MottTransition/NewGeometry/NiO.py ****
import os, sys
import shutil
import numpy as np
import scipy.linalg as la
from pyscf.pbc import scf, gto, df, dft, tools
from pyscf.tools import molden
from pyscf import mcpdft, lib, mcscf
from pyscf.mcscf import avas,project_init_guess
from pyscf import mcscf, dmrgscf
from functools import reduce
from pyscf import __config__
from pyscf.pbc.tools import k2gamma
# Import mcpdft from mrh
from mrh.my_pyscf import mcpdft
from pyscf.tools import molden
pre_orth_method = getattr(__config__, 'pbc_scf_analyze_pre_orth_method', 'ANO')

def getCell(nd=2.085, spin=0, maxMem=200000, basis='def2SVP', pseudo=None):
    cell = gto.Cell()
    cell.a = [[2*nd, nd, nd], [nd, 2*nd, nd], [2*nd, 2*nd, 4*nd]]
    cell.atom= f'''
Ni 0 0 0
Ni {2*nd} {2*nd} {2*nd}
Ni {nd} {nd} {2*nd}
Ni {3*nd} {3*nd} {4*nd}
O {nd} {nd} {nd}
O {3*nd} {3*nd} {3*nd}
O {2*nd} {2*nd} {3*nd}
O {4*nd} {4*nd} {5*nd}
    '''
    cell.basis = basis
    cell.pseudo = pseudo
    cell.output=f'NiO_{nd}.log'
    cell.verbose=lib.logger.INFO
    cell.precision=1e-12
    cell.exp_to_discard=0.1
    cell.spin=0
    cell.max_memory = maxMem
    cell.build()
    return cell

def get_gdf(cell, filename, restart=True):
    if not os.path.exists(filename) or restart:
        gdf = df.GDF(cell)
        gdf._cderi_to_save = filename
        gdf.build()
    return filename

def initguess(mol, mf, ao_label: list, activespacesize:int):
    '''
    Based on the ao_label find the orb which has
    highest character of that ao
    '''
    from pyscf.lo import orth
    baslst = mol.search_ao_label(ao_label)
    assert len(baslst) >=activespacesize
    orbindex=[]
    if len(mf.mo_coeff) > 1:
        mo_coeff = mf.mo_coeff[0]
    else:
        mo_coeff = mf.mo_coeff
    
    nkpts, nao = 1, mf.mo_coeff.shape[1]
    s_sc = mf.get_ovlp()
    orth_coeff = orth.orth_ao(mol, 'meta_lowdin',pre_orth_ao=None, s=s_sc)
    C = reduce(np.dot,(orth_coeff.T.conj(), s_sc, mf.mo_coeff))
    for orb in baslst:
        ao = C[orb]
        A = np.argsort(ao*ao.conj())[-activespacesize:][::-1]
        for element in A:
            if element not in orbindex:
                orbindex.append(element)
                break
    orbind = [x+1 for x in orbindex]
    return sorted(orbind[:activespacesize])

def runSCF(cell,nd=2.085, Restricted=True, Unrestricted=False):
    '''
    Run the Hartree Fock
    '''
    if Restricted:
        kmf = scf.ROHF(cell).density_fit()
    elif Unrestricted:
        kmf = scf.UHF(cell).density_fit()
    else:
        raise NotImplementedError

    kmf.max_cycle=100
    kmf.chkfile = f'NiO_{nd}.chk'
    kmf.init_guess='chk'
    kmf.with_df._cderi = get_gdf(cell, kmf.chkfile.rstrip('.chk')+'.h5', restart=False)
    kmf.exxdiv = None
    kmf.conv_tol = 1e-10
    kmf.kernel()

    if not kmf.converged:
        kmf.newton().run()

    assert kmf, "mean-field didn't converge"
    return kmf

def getfrags(nfrags: int):
    '''
    If NiO is in POSCAR Format where first N-atoms are Ni and
    next N-atoms are O, then get the frag atom no
    '''
    assert nfrags>=1, "You should know what you are doing"
    frags = []
    offset = nfrags * 2
    for i in range(nfrags):
        frag = [i * 2, i * 2 + offset, i * 2 + 1, i * 2 + offset + 1]
        frags.append(frag)
    return frags

def runLASSCF(cell, kmf):
    nfrags = 2
    ncas = 10 
    nelec = 16
    norb  = tuple([ncas,]*nfrags)
    nele  = tuple([nelec,]*nfrags)
    nspin = tuple([1,]*nfrags)

    orblst = initguess(cell, kmf, ao_label=['Ni 3d', ], activespacesize=sum(norb))

    frags = getfrags(nfrags)
    from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
    las = LASSCF(kmf, norb, nele, spin_sub=nspin)
    sortedmo = las.sort_mo(orblst, kmf.mo_coeff)
    mo0 = las.localize_init_guess(frags, sortedmo)
    #mo0 = sortedmo
    molden.from_mo(cell, f'NiO.{nfrags}.las.molden', mo0[:, las.ncore:las.ncore+(ncas*nfrags)])
    las_weights,las_charges,las_spins,las_smults=genModelSpace(nfrags)
    las = las.state_average(las_weights,las_charges,las_spins,las_smults)
    elasci = las.lasci_(mo0)
    las.mo_coeff = mo0
    return las

# Model Space for the band gap
def genModelSpace(nfrags):
    las_charges = []
    las_spins = [] #2s
    las_smults = [] #2s+1

    las_charges += [[0]*nfrags]
    las_spins += [[0]*nfrags]
    las_smults += [[las_spins[0][0]+1]*nfrags]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(-idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    nrootspaces = len(las_charges)
    las_weights = np.ones(nrootspaces)/nrootspaces
    return las_weights,las_charges,las_spins,las_smults

def processlas(las):
    from periodiclas.tools import sign_control, util
    las.ci = sign_control.fix_sign(las)
    las.dump_spaces()
    return las

def runLASSI(las):
    from mrh.my_pyscf.lassi import lassi
    lsi = lassi.LASSI(las)
    energies_lassi, civecs_lassi = lsi.kernel()
    return lsi, energies_lassi

def runLASSIPDFT(lsi, states=[0]):
    from mrh.my_pyscf import mcpdft
    mc = mcpdft.LASSI(lsi, 'tPBE', states=states)
    energies = mc.kernel()[0]
    return energies

def getBANDGAP(nele, lsi, energies_lassi):
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [list(x) for x in stateidx]
    ip = 27.21139*(min(energies_lassi[stateidx[1]]) - min(energies_lassi[stateidx[0]]))
    ea = 27.21139*(min(energies_lassi[stateidx[0]]) - min(energies_lassi[stateidx[2]]))
    return ip, ea

def getNatorbOcc(nele, lsi):
    from mrh.my_pyscf.lassi.lassi import root_make_rdm12s
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [int(list(x)[0]) for x in stateidx]
    for state in stateidx:
        natorb_casdm1 = root_make_rdm12s (lsi, lsi.ci, lsi.si, state=state, opt=lsi.opt)[0].sum (0)
        mo_occ = lsi._las.canonicalize (natorb_casdm1=natorb_casdm1)[2]
        mo_occ = [x for x in mo_occ if 0 < x < 2]
        print("State-",state, mo_occ)

def savepickel(mf, lsi, pdftenergy=0, R=2.47):
    """
    Save the LAS Band Structure Data
    """

    from periodiclas.tools import sign_control, util
    civec = lsi.get_sivec_vacuum_shuffle(state=0)
    charges = util.las_charges(lsi._las)

    data = {"energies_lassi":lsi.e_roots,
            "energies_lassipdft":pdftenergy,
            "civecs":civec,
            "charges":charges,
            "dist":R,
            "mf_coeff":mf.mo_coeff,
            "mf_occ":mf.mo_occ,
            "mf_ene":mf.mo_energy}


if __name__ == "__main__":
    for nd in np.arange(1.5, 3.6, 0.1):
        cell =  getCell(nd, maxMem=500000, basis='gth-dzvp-molopt-sr', pseudo='gth-pade')
        kmf = runSCF(cell, nd, Restricted=True, Unrestricted=False)

        las = runLASSCF(cell, kmf)
        las = processlas(las)

        lsi,energies_lassi = runLASSI(las)
        IP_LASSI, EA_LASSI = getBANDGAP(32, lsi,energies_lassi)
        energies_mcpdft = runLASSIPDFT(lsi, states=[x for x in range(len(energies_lassi))])
        IP_PDFT, EA_PDFT = getBANDGAP(32, lsi,np.asarray(energies_mcpdft))
        
        savepickel(kmf, lsi, pdftenergy=energies_mcpdft, R=nd)

        print("Results: LASSI ", )
        print("Ionization Energy: ", IP_LASSI)
        print("ElectAtt   Energy: ", EA_LASSI)
        print("Band Gap: ", IP_LASSI-EA_LASSI)

        print("Results: PDFT", )
        print("Ionization Energy: ", IP_PDFT)
        print("ElectAtt   Energy: ", EA_PDFT)
        print("Band Gap: ", IP_PDFT-EA_PDFT)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0555.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 128
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.26.2  scipy 1.11.4  h5py 3.10.0
Date: Sat Mar 15 01:20:18 2025
PySCF version 2.8.0
PySCF path  /home/jangidbhavnesh/bin/pyscf
GIT ORIG_HEAD a0665c4a7bf54e33f01295b3eea390be7a17d76d
GIT HEAD (branch master) 6f6d3741bf42543e02ccaa1d4ef43d9bf83b3dda
mrh path  /home/jangidbhavnesh/bin/mrh
GIT ORIG_HEAD ed1f605b415d72e71fb56d97b9d163809b62b172
GIT HEAD (branch master) ea89791c15c26abd3b0f0efdeadd7a286ca4585a

[ENV] PYSCF_EXT_PATH /home/jangidbhavnesh/bin/pyscf:/home/jangidbhavnesh/bin/pyscf-forge:/home/jangidbhavnesh/bin/dmrgscf:/home/jangidbhavnesh/bin:
[CONFIG] conf_file /home/jangidbhavnesh/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 8
[INPUT] num. electrons = 96
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ni     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Ni     6.600000000000   6.600000000000   6.600000000000 AA   12.472192422129  12.472192422129  12.472192422129 Bohr   0.0
[INPUT]  3 Ni     3.300000000000   3.300000000000   6.600000000000 AA    6.236096211065   6.236096211065  12.472192422129 Bohr   0.0
[INPUT]  4 Ni     9.900000000000   9.900000000000  13.200000000000 AA   18.708288633194  18.708288633194  24.944384844259 Bohr   0.0
[INPUT]  5 O      3.300000000000   3.300000000000   3.300000000000 AA    6.236096211065   6.236096211065   6.236096211065 Bohr   0.0
[INPUT]  6 O      9.900000000000   9.900000000000   9.900000000000 AA   18.708288633194  18.708288633194  18.708288633194 Bohr   0.0
[INPUT]  7 O      6.600000000000   6.600000000000   9.900000000000 AA   12.472192422129  12.472192422129  18.708288633194 Bohr   0.0
[INPUT]  8 O     13.200000000000  13.200000000000  16.500000000000 AA   24.944384844259  24.944384844259  31.180481055324 Bohr   0.0

nuclear repulsion = -302.421993820718
number of shells = 28
number of NR pGTOs = 500
number of NR cGTOs = 156
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:    525945.33
lattice vectors  a1 [12.472192422, 6.236096211, 6.236096211]
                 a2 [6.236096211, 12.472192422, 6.236096211]
                 a3 [12.472192422, 12.472192422, 24.944384844]
dimension = 3
low_dim_ft_type = None
Cell volume = 1940.12
exp_to_discard = 0.1
rcut = 21.840927745318478 (nimgs = [3 3 2])
lattice sum = 1471 cells
precision = 1e-12
pseudo = gth-pade
ke_cutoff = 1563.543132532536
    = [273 273 545] mesh (40618305 PWs)


******** <class 'pyscf.pbc.df.df.GDF'> ********
auxbasis = None
exp_to_discard = 0.1
_cderi_to_save = NiO_3.3000000000000016.h5
len(kpts) = 1
ETB for O: l = 0, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 1, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 2, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 3, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 4, exps = 0.32498323008 * 2^n , n = 0..6
ETB for Ni: l = 0, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 1, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 2, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 3, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 4, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 5, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 6, exps = 0.689956484316 * 2^n , n = 0..4

WARN: Even tempered Gaussians are generated as DF auxbasis for  O Ni

Drop 0 primitive fitting functions
make aux basis, num shells = 280, num cGTOs = 1680
auxcell.rcut 14.405988831603228


******** <class 'pyscf.pbc.df.rsdf_builder._RSGDFBuilder'> ********
mesh = [17 17 33] (9537 PWs)
ke_cutoff = 5.4141820021707465
omega = 0.246797757716796
exclude_d_aux = True
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.scf.rohf.ROHF'> ********
method = ROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.3000000000000016.chk
max_memory 500000 MB (current use 26967 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f456021e6a0>
number of electrons per cell  alpha = 48 beta = 48
Set gradient conv threshold to 1e-05

WARN: Fail in reading NiO_3.3000000000000016.chk. Use MINAO initial guess



******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
init E= -722.938692817638

WARN: HOMO 0.514819039960526 >= LUMO 0.515255581725996

cycle= 1 E= -715.251968175394  delta_E= 7.69  |g|=  8.8  |ddm|= 4.64
  HOMO = 0.316451989055283  LUMO = 0.320170369449521
cycle= 2 E= -678.361477806784  delta_E= 36.9  |g|= 11.4  |ddm|= 10.1
  HOMO = 0.26595814106262  LUMO = 0.431648121573309
cycle= 3 E= -720.793895399207  delta_E= -42.4  |g|= 4.92  |ddm|= 9.47
  HOMO = 0.0610801453068024  LUMO = 0.385133754170715
cycle= 4 E= -724.409378104001  delta_E= -3.62  |g|= 2.61  |ddm|= 2.27
  HOMO = 0.074249998704239  LUMO = 0.220717370905766
cycle= 5 E= -725.166194971788  delta_E= -0.757  |g|= 0.988  |ddm|= 0.955
  HOMO = 0.153111554315324  LUMO = 0.161967205462953
cycle= 6 E= -725.392459805828  delta_E= -0.226  |g|= 0.0527  |ddm|= 0.929
  HOMO = 0.1577700981722  LUMO = 0.161834996560551
cycle= 7 E= -724.980608930946  delta_E= 0.412  |g|=  1.5  |ddm|= 2.17
  HOMO = 0.157858210925243  LUMO = 0.161873160201871
cycle= 8 E= -724.97685897041  delta_E= 0.00375  |g|= 1.51  |ddm|= 0.0148
  HOMO = 0.157786830901423  LUMO = 0.161866942463812
cycle= 9 E= -724.976180509432  delta_E= 0.000678  |g|= 1.51  |ddm|= 0.0306
  HOMO = 0.158133013889121  LUMO = 0.161853159634244
cycle= 10 E= -724.973959519153  delta_E= 0.00222  |g|= 1.51  |ddm|= 0.0681
  HOMO = 0.158174580762272  LUMO = 0.16160249170989
cycle= 11 E= -724.944839035749  delta_E= 0.0291  |g|= 1.57  |ddm|= 0.113
  HOMO = 0.157726634644464  LUMO = 0.161482069032354
cycle= 12 E= -724.976572424394  delta_E= -0.0317  |g|= 1.51  |ddm|= 0.182

WARN: HOMO 0.161259985321307 >= LUMO 0.16180012132743

cycle= 13 E= -724.951415789396  delta_E= 0.0252  |g|= 1.54  |ddm|= 0.347

WARN: HOMO 0.162975462377601 >= LUMO 0.163272350962254

cycle= 14 E= -723.554141560972  delta_E=  1.4  |g|= 2.94  |ddm|= 2.06
  HOMO = 0.162427617942755  LUMO = 0.175297929747451
cycle= 15 E= -724.910990732775  delta_E= -1.36  |g|= 1.48  |ddm|= 3.06
  HOMO = 0.167777626516044  LUMO = 0.173514838462251
cycle= 16 E= -725.023103556844  delta_E= -0.112  |g|= 1.31  |ddm|= 0.632
  HOMO = 0.169196048470219  LUMO = 0.173094631334647
cycle= 17 E= -725.10125194287  delta_E= -0.0781  |g|=  1.1  |ddm|= 1.81
  HOMO = 0.170757394370671  LUMO = 0.173420237133421
cycle= 18 E= -724.504163558247  delta_E= 0.597  |g|= 2.02  |ddm|= 2.38
  HOMO = 0.164553542748727  LUMO = 0.173616167726959
cycle= 19 E= -724.691649396634  delta_E= -0.187  |g|= 1.77  |ddm|= 2.96
  HOMO = 0.167620013348533  LUMO = 0.173147886922941
cycle= 20 E= -725.001437959102  delta_E= -0.31  |g|= 1.29  |ddm|= 2.66
  HOMO = 0.168305832859152  LUMO = 0.176616543705183
cycle= 21 E= -724.200543751426  delta_E= 0.801  |g|= 2.33  |ddm|=    3
  HOMO = 0.172625177498566  LUMO = 0.175631456659687
cycle= 22 E= -724.51766987858  delta_E= -0.317  |g|= 2.06  |ddm|= 0.862
  HOMO = 0.159948566273398  LUMO = 0.171383580411526
cycle= 23 E= -724.804528567194  delta_E= -0.287  |g|= 1.46  |ddm|= 2.28
  HOMO = 0.165388503283678  LUMO = 0.178860139042968
cycle= 24 E= -724.63171212418  delta_E= 0.173  |g|= 1.76  |ddm|= 2.61
  HOMO = 0.16278548147996  LUMO = 0.17007257988078
cycle= 25 E= -725.244919648866  delta_E= -0.613  |g|= 0.742  |ddm|= 1.73
  HOMO = 0.168772115828744  LUMO = 0.174284721320427
cycle= 26 E= -723.954751672086  delta_E= 1.29  |g|= 2.53  |ddm|= 2.84
  HOMO = 0.163510434277971  LUMO = 0.169036299213758
cycle= 27 E= -725.006645763855  delta_E= -1.05  |g|= 1.14  |ddm|= 2.43

WARN: HOMO 0.16597060611976 >= LUMO 0.166029734378884

cycle= 28 E= -724.341458300065  delta_E= 0.665  |g|= 2.08  |ddm|= 2.69
  HOMO = 0.161381569275017  LUMO = 0.168404780413741
cycle= 29 E= -724.955482525035  delta_E= -0.614  |g|= 1.48  |ddm|= 2.28
  HOMO = 0.163100132820212  LUMO = 0.167660172458023
cycle= 30 E= -724.983915199469  delta_E= -0.0284  |g|= 1.33  |ddm|= 2.32
  HOMO = 0.16781798323433  LUMO = 0.177261528857516
cycle= 31 E= -724.50008271987  delta_E= 0.484  |g|= 1.95  |ddm|= 2.54
  HOMO = 0.161433713462241  LUMO = 0.171384321311925
cycle= 32 E= -724.633340111358  delta_E= -0.133  |g|= 1.79  |ddm|= 2.59
  HOMO = 0.161767057504429  LUMO = 0.165162721305276
cycle= 33 E= -724.928125508013  delta_E= -0.295  |g|= 1.24  |ddm|= 2.68
  HOMO = 0.171874160072077  LUMO = 0.21471207967548
cycle= 34 E= -717.870605633441  delta_E= 7.06  |g|= 3.18  |ddm|=  3.7
  HOMO = 0.171756059352905  LUMO = 0.175519127463353
cycle= 35 E= -725.043898355379  delta_E= -7.17  |g|= 1.26  |ddm|= 3.21
  HOMO = 0.167987414813937  LUMO = 0.178170927936659
cycle= 36 E= -718.489912389676  delta_E= 6.55  |g|= 2.82  |ddm|= 3.43
  HOMO = 0.165886262827264  LUMO = 0.167286217986242
cycle= 37 E= -724.327882444375  delta_E= -5.84  |g|= 1.93  |ddm|= 3.22
  HOMO = 0.161319379238579  LUMO = 0.169397079924898
cycle= 38 E= -724.563748603569  delta_E= -0.236  |g|= 1.68  |ddm|= 2.37
  HOMO = 0.144023165322454  LUMO = 0.173436053031402
cycle= 39 E= -724.414613365409  delta_E= 0.149  |g|=  2.1  |ddm|= 2.74
  HOMO = 0.162372474615598  LUMO = 0.168185001903949
cycle= 40 E= -724.604313768079  delta_E= -0.19  |g|= 1.76  |ddm|= 2.77

WARN: HOMO 0.158384284749328 >= LUMO 0.159290188701027

cycle= 41 E= -723.663941855738  delta_E= 0.94  |g|= 2.55  |ddm|= 2.27
  HOMO = 0.204288211988169  LUMO = 0.215866390134973
cycle= 42 E= -717.794835197734  delta_E= 5.87  |g|=  3.6  |ddm|= 3.28
  HOMO = 0.168125633010222  LUMO = 0.187001694597922
cycle= 43 E= -723.95216539902  delta_E= -6.16  |g|= 2.45  |ddm|=  3.5
  HOMO = 0.158119237512012  LUMO = 0.172712137847795
cycle= 44 E= -724.36263756729  delta_E= -0.41  |g|=  1.9  |ddm|= 0.814
  HOMO = 0.168843131291704  LUMO = 0.182789329129425
cycle= 45 E= -718.186627406116  delta_E= 6.18  |g|= 3.35  |ddm|= 3.43
  HOMO = 0.165029912081529  LUMO = 0.172945749138024
cycle= 46 E= -723.971319220629  delta_E= -5.78  |g|= 2.72  |ddm|= 3.73
  HOMO = 0.156984278610183  LUMO = 0.168743383827282
cycle= 47 E= -723.904834911253  delta_E= 0.0665  |g|=  2.5  |ddm|= 2.38
  HOMO = 0.150555241321178  LUMO = 0.195099708799945
cycle= 48 E= -723.729319826279  delta_E= 0.176  |g|= 2.95  |ddm|= 3.34
  HOMO = 0.174251218129331  LUMO = 0.190293876682562
cycle= 49 E= -723.228493902026  delta_E= 0.501  |g|= 3.19  |ddm|= 2.71
  HOMO = 0.164568504039948  LUMO = 0.188877789276549
cycle= 50 E= -724.188281523531  delta_E= -0.96  |g|= 2.35  |ddm|= 2.57
  HOMO = 0.162400650420904  LUMO = 0.164600719707937
cycle= 51 E= -724.191339647265  delta_E= -0.00306  |g|= 2.11  |ddm|= 2.73
  HOMO = 0.162260379912352  LUMO = 0.166617572029349
cycle= 52 E= -723.905512008481  delta_E= 0.286  |g|= 2.38  |ddm|= 2.01
  HOMO = 0.167400632982584  LUMO = 0.177044719818623
cycle= 53 E= -724.03507004498  delta_E= -0.13  |g|= 2.32  |ddm|= 1.63
  HOMO = 0.158930595556339  LUMO = 0.170125201424868
cycle= 54 E= -724.625640801901  delta_E= -0.591  |g|= 1.85  |ddm|= 2.89
  HOMO = 0.164830178241921  LUMO = 0.166581292870275
cycle= 55 E= -724.564826468273  delta_E= 0.0608  |g|= 1.86  |ddm|= 2.28
  HOMO = 0.160952870423426  LUMO = 0.167061524968119
cycle= 56 E= -725.179679644311  delta_E= -0.615  |g|= 1.15  |ddm|= 2.35
  HOMO = 0.160165777440413  LUMO = 0.166784209248145
cycle= 57 E= -724.481934330292  delta_E= 0.698  |g|= 2.02  |ddm|= 2.52
  HOMO = 0.166743217712576  LUMO = 0.168327649945912
cycle= 58 E= -724.886482770692  delta_E= -0.405  |g|= 1.51  |ddm|= 2.07
  HOMO = 0.163823049641427  LUMO = 0.166825089826713
cycle= 59 E= -724.956056038881  delta_E= -0.0696  |g|= 1.44  |ddm|= 2.34
  HOMO = 0.165274469483495  LUMO = 0.167866684998597
cycle= 60 E= -725.343705986606  delta_E= -0.388  |g|= 0.503  |ddm|= 1.89
  HOMO = 0.165194748020528  LUMO = 0.167988610281511
cycle= 61 E= -724.965281698551  delta_E= 0.378  |g|= 1.26  |ddm|= 2.17
  HOMO = 0.164781118337244  LUMO = 0.168616526271836
cycle= 62 E= -724.752057364392  delta_E= 0.213  |g|= 1.57  |ddm|=  2.3
  HOMO = 0.161434796569692  LUMO = 0.166538500808649
cycle= 63 E= -724.906258334455  delta_E= -0.154  |g|= 1.53  |ddm|=  2.3
  HOMO = 0.157453903487114  LUMO = 0.170988389587186
cycle= 64 E= -724.038685015703  delta_E= 0.868  |g|= 2.39  |ddm|= 2.27
  HOMO = 0.166662445564903  LUMO = 0.168691117684909
cycle= 65 E= -725.332965964135  delta_E= -1.29  |g|= 0.478  |ddm|= 2.36
  HOMO = 0.164607209692239  LUMO = 0.172471068125088
cycle= 66 E= -725.296542005957  delta_E= 0.0364  |g|= 0.697  |ddm|=    2
  HOMO = 0.164580479224293  LUMO = 0.167419997665231
cycle= 67 E= -725.344578368223  delta_E= -0.048  |g|= 0.497  |ddm|= 0.907
  HOMO = 0.163370534980503  LUMO = 0.167253379509227
cycle= 68 E= -724.558049007132  delta_E= 0.787  |g|= 1.91  |ddm|=  2.3
  HOMO = 0.16396453096164  LUMO = 0.167556308838216
cycle= 69 E= -725.321198529277  delta_E= -0.763  |g|= 0.557  |ddm|= 2.27
  HOMO = 0.165291734379308  LUMO = 0.168201485755351
cycle= 70 E= -724.982274746181  delta_E= 0.339  |g|= 1.34  |ddm|=  1.8
  HOMO = 0.164960492018612  LUMO = 0.169151688799205
cycle= 71 E= -725.340084737903  delta_E= -0.358  |g|= 0.542  |ddm|= 1.48
  HOMO = 0.165411693882281  LUMO = 0.167696084728271
cycle= 72 E= -725.352031879849  delta_E= -0.0119  |g|= 0.493  |ddm|= 0.545
  HOMO = 0.166082052655577  LUMO = 0.167158247223186
cycle= 73 E= -725.053218653473  delta_E= 0.299  |g|= 1.18  |ddm|= 1.82
  HOMO = 0.159948463489413  LUMO = 0.166970039898105
cycle= 74 E= -723.890246889509  delta_E= 1.16  |g|= 2.51  |ddm|= 2.79
  HOMO = 0.160741645706633  LUMO = 0.167867748492378
cycle= 75 E= -725.218739274399  delta_E= -1.33  |g|= 0.74  |ddm|= 2.35
  HOMO = 0.163450751708117  LUMO = 0.166757939514223
cycle= 76 E= -724.932761049558  delta_E= 0.286  |g|= 1.41  |ddm|= 2.13
  HOMO = 0.165053050892152  LUMO = 0.16791144360122
cycle= 77 E= -725.135167645386  delta_E= -0.202  |g|= 1.13  |ddm|= 2.06
  HOMO = 0.162500029674155  LUMO = 0.171542976961174
cycle= 78 E= -724.674926714011  delta_E= 0.46  |g|= 1.75  |ddm|= 2.32
  HOMO = 0.165691700080781  LUMO = 0.169200252979293
cycle= 79 E= -725.063861237133  delta_E= -0.389  |g|= 1.07  |ddm|=  2.1

WARN: HOMO 0.168283314138318 >= LUMO 0.168733832944649

cycle= 80 E= -725.296988350141  delta_E= -0.233  |g|= 0.521  |ddm|= 1.72
  HOMO = 0.167015419355516  LUMO = 0.172206286263806
cycle= 81 E= -725.117237566132  delta_E= 0.18  |g|= 1.22  |ddm|= 2.39
  HOMO = 0.164232410476399  LUMO = 0.168207101141452
cycle= 82 E= -725.356678513758  delta_E= -0.239  |g|= 0.374  |ddm|= 1.48
  HOMO = 0.165018534913224  LUMO = 0.170986013588317
cycle= 83 E= -725.267520654649  delta_E= 0.0892  |g|= 0.774  |ddm|= 1.48
  HOMO = 0.165001838917463  LUMO = 0.168892625212724
cycle= 84 E= -725.334705588559  delta_E= -0.0672  |g|= 0.632  |ddm|= 0.91
  HOMO = 0.163524614336889  LUMO = 0.167352028790985
cycle= 85 E= -725.163747938092  delta_E= 0.171  |g|= 1.02  |ddm|=  1.3
  HOMO = 0.164657014580869  LUMO = 0.167998156745049
cycle= 86 E= -725.358211946131  delta_E= -0.194  |g|= 0.478  |ddm|= 1.27
  HOMO = 0.166852334404475  LUMO = 0.16879371185637
cycle= 87 E= -725.056937577324  delta_E= 0.301  |g|= 1.16  |ddm|= 1.92
  HOMO = 0.158666690327726  LUMO = 0.166088448116525
cycle= 88 E= -724.373785523352  delta_E= 0.683  |g|= 1.96  |ddm|= 2.65
  HOMO = 0.157570232019036  LUMO = 0.16611485978181
cycle= 89 E= -724.600007337534  delta_E= -0.226  |g|= 1.81  |ddm|= 2.53
  HOMO = 0.160668704790642  LUMO = 0.170380525528173
cycle= 90 E= -725.278659523514  delta_E= -0.679  |g|= 0.548  |ddm|= 1.75
  HOMO = 0.165365201122089  LUMO = 0.168454570410852
cycle= 91 E= -725.198906840409  delta_E= 0.0798  |g|= 0.73  |ddm|= 2.33

WARN: HOMO 0.166859032680579 >= LUMO 0.1675992798296

cycle= 92 E= -725.327324195328  delta_E= -0.128  |g|= 0.539  |ddm|= 1.51
  HOMO = 0.161358395127094  LUMO = 0.169419714559299
cycle= 93 E= -724.194392955747  delta_E= 1.13  |g|=  2.3  |ddm|= 2.56
  HOMO = 0.163548205405313  LUMO = 0.169519626590464
cycle= 94 E= -725.367458460796  delta_E= -1.17  |g|= 0.336  |ddm|= 2.35

WARN: HOMO 0.167140961429346 >= LUMO 0.167527169241356

cycle= 95 E= -725.362034216698  delta_E= 0.00542  |g|= 0.395  |ddm|= 1.59
  HOMO = 0.166646327489781  LUMO = 0.168537893136724
cycle= 96 E= -725.352278222721  delta_E= 0.00976  |g|= 0.498  |ddm|= 1.54
  HOMO = 0.166414043967097  LUMO = 0.167905946826118
cycle= 97 E= -724.9306160723  delta_E= 0.422  |g|= 1.37  |ddm|= 1.94
  HOMO = 0.166551197323467  LUMO = 0.168169643703021
cycle= 98 E= -725.356224030999  delta_E= -0.426  |g|= 0.499  |ddm|= 1.96

WARN: HOMO 0.162836954102857 >= LUMO 0.163554695305991

cycle= 99 E= -724.993590929965  delta_E= 0.363  |g|= 1.15  |ddm|= 1.98
  HOMO = 0.162985665946658  LUMO = 0.169082247569979
cycle= 100 E= -725.278183356769  delta_E= -0.285  |g|= 0.648  |ddm|=  1.4
SCF not converged.
SCF energy = -725.278183356769




******** <class 'pyscf.soscf.newton_ah.SecondOrderROHF'> ********
method = SecondOrderROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.3000000000000016.chk
max_memory 500000 MB (current use 28144 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f456021e6a0>
number of electrons per cell  alpha = 48 beta = 48
******** <class 'pyscf.pbc.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-10
conv_tol_grad = None
max. SCF cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.3000000000000016.chk
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 500000 MB (current use 28144 MB)
Set conv_tol_grad to 1e-05


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
  HOMO = 0.148623304162505  LUMO = 0.167780481318035
Initial guess E= -725.278183356769  |g|= 0.64827
macro= 0  E= -725.347517796143  delta_E= -0.0693344  |g|= 0.250205  3 KF 17 JK
macro= 1  E= -725.366920886684  delta_E= -0.0194031  |g|= 0.30852  3 KF 17 JK
macro= 2  E= -725.380957217791  delta_E= -0.0140363  |g|= 0.204723  3 KF 18 JK
macro= 3  E= -725.394132971598  delta_E= -0.0131758  |g|= 0.118713  3 KF 19 JK
macro= 4  E= -725.404796662392  delta_E= -0.0106637  |g|= 0.166647  4 KF 22 JK
macro= 5  E= -725.42447482732  delta_E= -0.0196782  |g|= 0.200698  3 KF 13 JK
macro= 6  E= -725.441092461798  delta_E= -0.0166176  |g|= 0.0772457  4 KF 17 JK
macro= 7  E= -725.459446429216  delta_E= -0.018354  |g|= 0.0590197  4 KF 18 JK
macro= 8  E= -725.463154690245  delta_E= -0.00370826  |g|= 0.0212095  4 KF 23 JK
macro= 9  E= -725.463598848167  delta_E= -0.000444158  |g|= 0.0288535  2 KF 9 JK
macro= 10  E= -725.464103491037  delta_E= -0.000504643  |g|= 0.00528531  3 KF 25 JK
macro= 11  E= -725.4641168353  delta_E= -1.33443e-05  |g|= 0.000388804  3 KF 30 JK
macro= 12  E= -725.464116917768  delta_E= -8.24684e-08  |g|= 2.14928e-05  3 KF 36 JK
macro= 13  E= -725.46411691783  delta_E= -6.21867e-11  |g|= 6.34097e-06  1 KF 5 JK
Canonicalize SCF orbitals
macro X = 14  E=-725.46411691783  |g|= 6.34097e-06  total 44 KF 284 JK

WARN: HOMO 0.1678571787226911 > LUMO 0.16079918822729636 was found in the canonicalized orbitals.

converged SCF energy = -725.46411691783


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.688104e-03 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 1.334913e-03 ; sigma = 2.084538e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 9.247562e-06 ; sigma = 1.838936e-04 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 6.141483e-08 ; sigma = 1.955527e-09 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 5.845254e-10 ; sigma = 7.105427e-15 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 2.778924e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 8.889265e-04 ; sigma = 2.185136e-01 ; 1/2 fragment CI solvers converged
Cycle 2: max grad = 1.203050e-05 ; sigma = 8.751233e-05 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 2.561844e-06 ; sigma = 2.229974e-09 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 7.385827e-07 ; sigma = 5.214957e-10 ; 2/2 fragment CI solvers converged
Cycle 5: max grad = 3.873223e-07 ; sigma = 3.148415e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 5 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.380669e-01 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 4.099710e-03 ; sigma = 1.396794e-01 ; 1/2 fragment CI solvers converged
Cycle 2: max grad = 1.289522e-04 ; sigma = 2.087832e-03 ; 1/2 fragment CI solvers converged
Cycle 3: max grad = 1.883366e-06 ; sigma = 1.109268e-06 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.367335e-06 ; sigma = 6.746390e-10 ; 2/2 fragment CI solvers converged
Cycle 5: max grad = 8.207735e-07 ; sigma = 2.356870e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 5 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 5.231921e-03 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 1.478965e-03 ; sigma = 9.979803e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 1.042358e-03 ; sigma = 1.760156e-03 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 1.998339e-04 ; sigma = 8.020364e-04 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 8.082656e-06 ; sigma = 8.748315e-06 ; 2/2 fragment CI solvers converged
Cycle 5: max grad = 1.528797e-06 ; sigma = 2.749894e-08 ; 2/2 fragment CI solvers converged
Cycle 6: max grad = 3.024735e-08 ; sigma = 2.115357e-10 ; 2/2 fragment CI solvers converged
Cycle 7: max grad = 1.348219e-08 ; sigma = 1.790568e-12 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 7 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 3.956018e-03 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 2.675034e-03 ; sigma = 1.755508e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 6.323710e-05 ; sigma = 3.000903e-03 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 2.091848e-07 ; sigma = 2.799012e-07 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 4.473199e-09 ; sigma = 5.712764e-12 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
LASCI state-average energy = -725.718339333814
LASCI state 0 energy = -725.727836422643
LASCI state 1 energy = -725.750937121161
LASCI state 2 energy = -725.739142400919
LASCI state 3 energy = -725.674134552693
LASCI state 4 energy = -725.699646171655
******** LAS space tables ********
LAS space 0: (16e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.727836422643
S^2 = 0.0000000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 1: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.750937121161
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+7e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 2: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.739142400919
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+7e,10o)     2    A        1
LAS space 3: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.674134552693
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (9e+8e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 4: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.699646171655
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (9e+8e,10o)     2    A        1
LASSI op_o0 memory check: 1709.058096 MB needed of 471885.54752 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Symmetry analysis of 5 LAS rootspaces:
 ix            Energy  <S**2>  Neleca  Nelecb  Nelec   Wfnsym
  0   -725.7278364226   0.000      16      16      32       A
  1   -725.7509371212   0.750      16      15      31       A
  2   -725.7391424009   0.750      16      15      31       A
  3   -725.6741345527   0.750      17      16      33       A
  4   -725.6996461717   0.750      17      16      33       A
Build + diag H matrix LASSI symmetry block 0
['neleca', 'nelecb', 'irrep'] = (17, 16, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 123.54336 MB needed of 471829.469184 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 1
['neleca', 'nelecb', 'irrep'] = (16, 15, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 1652.196096 MB needed of 471829.469184 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 2
['neleca', 'nelecb', 'irrep'] = (16, 16, 0)
(1 rootspaces; 1 states)
LASSI eigenvalues (5 total):
 ix            Energy  <S**2>  Neleca  Nelecb  Wfnsym
  0   -725.7509371212   0.750      16      15       A
  1   -725.7391424009   0.750      16      15       A
  2   -725.7278364226   0.000      16      16       A
  3   -725.6996461717   0.750      17      16       A
  4   -725.6741345527   0.750      17      16       A
Building tPBE functional
Building tPBE functional
Periodic OT-FNAL class is used
LASSI op_o0 memory check: 1709.058096 MB needed of 471829.469184 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 0 E = -740.2081079277177, Eot(tPBE) = -80.30679922002011


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 1 E = -740.3266835461914, Eot(tPBE) = -80.35645483959546


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 2 E = -740.5569330261463, Eot(tPBE) = -81.65289143084452


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 3 E = -740.5653097341025, Eot(tPBE) = -82.60914853870072


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [31 31 59] (56699 PWs)
ke_cutoff = 17.786433843068743
omega = 0.45660571287095014
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 4 E = -740.5627726683011, Eot(tPBE) = -82.84819035506291

Discarded 16 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /project/lgagliardi/jangidbhavnesh/Re/Final/MottTransition/NewGeometry/NiO.py ****
import os, sys
import shutil
import numpy as np
import scipy.linalg as la
from pyscf.pbc import scf, gto, df, dft, tools
from pyscf.tools import molden
from pyscf import mcpdft, lib, mcscf
from pyscf.mcscf import avas,project_init_guess
from pyscf import mcscf, dmrgscf
from functools import reduce
from pyscf import __config__
from pyscf.pbc.tools import k2gamma
# Import mcpdft from mrh
from mrh.my_pyscf import mcpdft
from pyscf.tools import molden
pre_orth_method = getattr(__config__, 'pbc_scf_analyze_pre_orth_method', 'ANO')

def getCell(nd=2.085, spin=0, maxMem=200000, basis='def2SVP', pseudo=None):
    cell = gto.Cell()
    cell.a = [[2*nd, nd, nd], [nd, 2*nd, nd], [2*nd, 2*nd, 4*nd]]
    cell.atom= f'''
Ni 0 0 0
Ni {2*nd} {2*nd} {2*nd}
Ni {nd} {nd} {2*nd}
Ni {3*nd} {3*nd} {4*nd}
O {nd} {nd} {nd}
O {3*nd} {3*nd} {3*nd}
O {2*nd} {2*nd} {3*nd}
O {4*nd} {4*nd} {5*nd}
    '''
    cell.basis = basis
    cell.pseudo = pseudo
    cell.output=f'NiO_{nd}.log'
    cell.verbose=lib.logger.INFO
    cell.precision=1e-12
    cell.exp_to_discard=0.1
    cell.spin=0
    cell.max_memory = maxMem
    cell.build()
    return cell

def get_gdf(cell, filename, restart=True):
    if not os.path.exists(filename) or restart:
        gdf = df.GDF(cell)
        gdf._cderi_to_save = filename
        gdf.build()
    return filename

def initguess(mol, mf, ao_label: list, activespacesize:int):
    '''
    Based on the ao_label find the orb which has
    highest character of that ao
    '''
    from pyscf.lo import orth
    baslst = mol.search_ao_label(ao_label)
    assert len(baslst) >=activespacesize
    orbindex=[]
    if len(mf.mo_coeff) > 1:
        mo_coeff = mf.mo_coeff[0]
    else:
        mo_coeff = mf.mo_coeff
    
    nkpts, nao = 1, mf.mo_coeff.shape[1]
    s_sc = mf.get_ovlp()
    orth_coeff = orth.orth_ao(mol, 'meta_lowdin',pre_orth_ao=None, s=s_sc)
    C = reduce(np.dot,(orth_coeff.T.conj(), s_sc, mf.mo_coeff))
    for orb in baslst:
        ao = C[orb]
        A = np.argsort(ao*ao.conj())[-activespacesize:][::-1]
        for element in A:
            if element not in orbindex:
                orbindex.append(element)
                break
    orbind = [x+1 for x in orbindex]
    return sorted(orbind[:activespacesize])

def runSCF(cell,nd=2.085, Restricted=True, Unrestricted=False):
    '''
    Run the Hartree Fock
    '''
    if Restricted:
        kmf = scf.ROHF(cell).density_fit()
    elif Unrestricted:
        kmf = scf.UHF(cell).density_fit()
    else:
        raise NotImplementedError

    kmf.max_cycle=100
    kmf.chkfile = f'NiO_{nd}.chk'
    kmf.init_guess='chk'
    kmf.with_df._cderi = get_gdf(cell, kmf.chkfile.rstrip('.chk')+'.h5', restart=False)
    kmf.exxdiv = None
    kmf.conv_tol = 1e-10
    kmf.kernel()

    if not kmf.converged:
        kmf.newton().run()

    assert kmf, "mean-field didn't converge"
    return kmf

def getfrags(nfrags: int):
    '''
    If NiO is in POSCAR Format where first N-atoms are Ni and
    next N-atoms are O, then get the frag atom no
    '''
    assert nfrags>=1, "You should know what you are doing"
    frags = []
    offset = nfrags * 2
    for i in range(nfrags):
        frag = [i * 2, i * 2 + offset, i * 2 + 1, i * 2 + offset + 1]
        frags.append(frag)
    return frags

def runLASSCF(cell, kmf):
    nfrags = 2
    ncas = 10 
    nelec = 16
    norb  = tuple([ncas,]*nfrags)
    nele  = tuple([nelec,]*nfrags)
    nspin = tuple([1,]*nfrags)

    orblst = initguess(cell, kmf, ao_label=['Ni 3d', ], activespacesize=sum(norb))

    frags = getfrags(nfrags)
    from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
    las = LASSCF(kmf, norb, nele, spin_sub=nspin)
    sortedmo = las.sort_mo(orblst, kmf.mo_coeff)
    mo0 = las.localize_init_guess(frags, sortedmo)
    #mo0 = sortedmo
    molden.from_mo(cell, f'NiO.{nfrags}.las.molden', mo0[:, las.ncore:las.ncore+(ncas*nfrags)])
    las_weights,las_charges,las_spins,las_smults=genModelSpace(nfrags)
    las = las.state_average(las_weights,las_charges,las_spins,las_smults)
    elasci = las.lasci_(mo0)
    las.mo_coeff = mo0
    return las

# Model Space for the band gap
def genModelSpace(nfrags):
    las_charges = []
    las_spins = [] #2s
    las_smults = [] #2s+1

    las_charges += [[0]*nfrags]
    las_spins += [[0]*nfrags]
    las_smults += [[las_spins[0][0]+1]*nfrags]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    for i in range(nfrags):
        idxarr = np.eye(nfrags)[:,i].astype(int)
        las_charges += [list(-idxarr)]
        spins = idxarr
        las_spins += [list(spins)]
        las_smults += [list(spins + 1)]

    nrootspaces = len(las_charges)
    las_weights = np.ones(nrootspaces)/nrootspaces
    return las_weights,las_charges,las_spins,las_smults

def processlas(las):
    from periodiclas.tools import sign_control, util
    las.ci = sign_control.fix_sign(las)
    las.dump_spaces()
    return las

def runLASSI(las):
    from mrh.my_pyscf.lassi import lassi
    lsi = lassi.LASSI(las)
    energies_lassi, civecs_lassi = lsi.kernel()
    return lsi, energies_lassi

def runLASSIPDFT(lsi, states=[0]):
    from mrh.my_pyscf import mcpdft
    mc = mcpdft.LASSI(lsi, 'tPBE', states=states)
    energies = mc.kernel()[0]
    return energies

def getBANDGAP(nele, lsi, energies_lassi):
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [list(x) for x in stateidx]
    ip = 27.21139*(min(energies_lassi[stateidx[1]]) - min(energies_lassi[stateidx[0]]))
    ea = 27.21139*(min(energies_lassi[stateidx[0]]) - min(energies_lassi[stateidx[2]]))
    return ip, ea

def getNatorbOcc(nele, lsi):
    from mrh.my_pyscf.lassi.lassi import root_make_rdm12s
    stateidx = [
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele - 1))[0],
        np.where((np.asarray(lsi.rootsym)[:, :2].sum(axis=1) == nele + 1))[0]]
    stateidx = [int(list(x)[0]) for x in stateidx]
    for state in stateidx:
        natorb_casdm1 = root_make_rdm12s (lsi, lsi.ci, lsi.si, state=state, opt=lsi.opt)[0].sum (0)
        mo_occ = lsi._las.canonicalize (natorb_casdm1=natorb_casdm1)[2]
        mo_occ = [x for x in mo_occ if 0 < x < 2]
        print("State-",state, mo_occ)

def savepickel(mf, lsi, pdftenergy=0, R=2.47):
    """
    Save the LAS Band Structure Data
    """

    from periodiclas.tools import sign_control, util
    civec = lsi.get_sivec_vacuum_shuffle(state=0)
    charges = util.las_charges(lsi._las)

    data = {"energies_lassi":lsi.e_roots,
            "energies_lassipdft":pdftenergy,
            "civecs":civec,
            "charges":charges,
            "dist":R,
            "mf_coeff":mf.mo_coeff,
            "mf_occ":mf.mo_occ,
            "mf_ene":mf.mo_energy}


if __name__ == "__main__":
    nd = 2.085
    for nd in [1.7, 2.1, 2.3, 2.7, 3.1, 3.5, 3.9]:
        cell =  getCell(nd, maxMem=500000, basis='gth-dzvp-molopt-sr', pseudo='gth-pade')
        kmf = runSCF(cell, nd, Restricted=True, Unrestricted=False)

        #molden.from_mo(cell, f'NiO_{nU}.molden', kmf.mo_coeff)
        las = runLASSCF(cell, kmf)
        las = processlas(las)

        lsi,energies_lassi = runLASSI(las)
        IP_LASSI, EA_LASSI = getBANDGAP(32, lsi,energies_lassi)
        energies_mcpdft = runLASSIPDFT(lsi, states=[x for x in range(len(energies_lassi))])
        IP_PDFT, EA_PDFT = getBANDGAP(32, lsi,np.asarray(energies_mcpdft))
        
        savepickel(kmf, lsi, pdftenergy=energies_mcpdft, R=nd)

        print("Results: LASSI ", )
        print("Ionization Energy: ", IP_LASSI)
        print("ElectAtt   Energy: ", EA_LASSI)
        print("Band Gap: ", IP_LASSI-EA_LASSI)

        print("Results: PDFT", )
        print("Ionization Energy: ", IP_PDFT)
        print("ElectAtt   Energy: ", EA_PDFT)
        print("Band Gap: ", IP_PDFT-EA_PDFT)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0555.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 128
Python 3.9.13 (main, Aug 25 2022, 23:26:10) 
[GCC 11.2.0]
numpy 1.26.2  scipy 1.11.4  h5py 3.10.0
Date: Fri Mar 14 23:36:09 2025
PySCF version 2.8.0
PySCF path  /home/jangidbhavnesh/bin/pyscf
GIT ORIG_HEAD a0665c4a7bf54e33f01295b3eea390be7a17d76d
GIT HEAD (branch master) 6f6d3741bf42543e02ccaa1d4ef43d9bf83b3dda
mrh path  /home/jangidbhavnesh/bin/mrh
GIT ORIG_HEAD ed1f605b415d72e71fb56d97b9d163809b62b172
GIT HEAD (branch master) ea89791c15c26abd3b0f0efdeadd7a286ca4585a

[ENV] PYSCF_EXT_PATH /home/jangidbhavnesh/bin/pyscf:/home/jangidbhavnesh/bin/pyscf-forge:/home/jangidbhavnesh/bin/dmrgscf:/home/jangidbhavnesh/bin:
[CONFIG] conf_file /home/jangidbhavnesh/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 8
[INPUT] num. electrons = 96
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ni     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Ni     6.200000000000   6.200000000000   6.200000000000 AA   11.716301972303  11.716301972303  11.716301972303 Bohr   0.0
[INPUT]  3 Ni     3.100000000000   3.100000000000   6.200000000000 AA    5.858150986152   5.858150986152  11.716301972303 Bohr   0.0
[INPUT]  4 Ni     9.300000000000   9.300000000000  12.400000000000 AA   17.574452958455  17.574452958455  23.432603944607 Bohr   0.0
[INPUT]  5 O      3.100000000000   3.100000000000   3.100000000000 AA    5.858150986152   5.858150986152   5.858150986152 Bohr   0.0
[INPUT]  6 O      9.300000000000   9.300000000000   9.300000000000 AA   17.574452958455  17.574452958455  17.574452958455 Bohr   0.0
[INPUT]  7 O      6.200000000000   6.200000000000   9.300000000000 AA   11.716301972303  11.716301972303  17.574452958455 Bohr   0.0
[INPUT]  8 O     12.400000000000  12.400000000000  15.500000000000 AA   23.432603944607  23.432603944607  29.290754930758 Bohr   0.0

nuclear repulsion = -321.933090196249
number of shells = 28
number of NR pGTOs = 500
number of NR cGTOs = 156
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:    104967.58
lattice vectors  a1 [11.716301972, 5.858150986, 5.858150986]
                 a2 [5.858150986, 11.716301972, 5.858150986]
                 a3 [11.716301972, 11.716301972, 23.432603945]
dimension = 3
low_dim_ft_type = None
Cell volume = 1608.32
exp_to_discard = 0.1
rcut = 21.840927745318478 (nimgs = [4 4 2])
lattice sum = 1523 cells
precision = 1e-12
pseudo = gth-pade
ke_cutoff = 1563.543132532536
    = [257 257 513] mesh (33883137 PWs)


******** <class 'pyscf.pbc.df.df.GDF'> ********
auxbasis = None
exp_to_discard = 0.1
_cderi_to_save = NiO_3.1.h5
len(kpts) = 1
ETB for O: l = 0, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 1, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 2, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 3, exps = 0.32498323008 * 2^n , n = 0..6
ETB for O: l = 4, exps = 0.32498323008 * 2^n , n = 0..6
ETB for Ni: l = 0, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 1, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 2, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 3, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 4, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 5, exps = 0.689956484316 * 2^n , n = 0..4
ETB for Ni: l = 6, exps = 0.689956484316 * 2^n , n = 0..4

WARN: Even tempered Gaussians are generated as DF auxbasis for  O Ni

Drop 0 primitive fitting functions
make aux basis, num shells = 280, num cGTOs = 1680
auxcell.rcut 14.405988831603228


******** <class 'pyscf.pbc.df.rsdf_builder._RSGDFBuilder'> ********
mesh = [17 17 31] (8959 PWs)
ke_cutoff = 5.392372630568293
omega = 0.2463337407300708
exclude_d_aux = True
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.scf.rohf.ROHF'> ********
method = ROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.1.chk
max_memory 500000 MB (current use 8670 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f23ec366eb0>
number of electrons per cell  alpha = 48 beta = 48
Set gradient conv threshold to 1e-05

WARN: Fail in reading NiO_3.1.chk. Use MINAO initial guess



******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
init E= -722.367534787459

WARN: HOMO 0.555422890710643 >= LUMO 0.55542289071065

cycle= 1 E= -713.504940384978  delta_E= 8.86  |g|= 9.06  |ddm|= 4.76
  HOMO = 0.227760455392884  LUMO = 0.259127525171364
cycle= 2 E= -668.404826363988  delta_E= 45.1  |g|= 11.6  |ddm|= 9.56
  HOMO = 0.609593622164942  LUMO = 0.648527939168353
cycle= 3 E= -648.213318148824  delta_E= 20.2  |g|= 9.87  |ddm|= 10.4
  HOMO = 0.453911242688312  LUMO = 0.462387448930773
cycle= 4 E= -708.588665534511  delta_E= -60.4  |g|=  6.5  |ddm|=  5.9
  HOMO = 0.422254079480398  LUMO = 0.504871427055811
cycle= 5 E= -716.76025806201  delta_E= -8.17  |g|= 5.19  |ddm|= 3.28
  HOMO = 0.281202901856426  LUMO = 0.56977751017192
cycle= 6 E= -717.426938174012  delta_E= -0.667  |g|= 4.97  |ddm|= 0.533
  HOMO = 0.151372889482616  LUMO = 0.570016917023751
cycle= 7 E= -717.419787105801  delta_E= 0.00715  |g|= 4.71  |ddm|= 0.676
  HOMO = 0.144338909593181  LUMO = 0.528101449269415
cycle= 8 E= -718.634896619961  delta_E= -1.22  |g|= 4.12  |ddm|= 0.903
  HOMO = 0.185242351979022  LUMO = 0.369532644208426
cycle= 9 E= -719.287669669068  delta_E= -0.653  |g|=  3.5  |ddm|= 0.767

WARN: HOMO 0.310379123590427 >= LUMO 0.311078406141974

cycle= 10 E= -708.348263136287  delta_E= 10.9  |g|=  7.1  |ddm|= 5.74
  HOMO = 0.209182766470725  LUMO = 0.210378022782549
cycle= 11 E= -712.543192408525  delta_E= -4.19  |g|=  7.4  |ddm|= 5.43
  HOMO = 0.185828131156475  LUMO = 0.209823904084109
cycle= 12 E= -715.784839555795  delta_E= -3.24  |g|= 6.02  |ddm|= 4.51
  HOMO = 0.134838058915556  LUMO = 0.204034295281477
cycle= 13 E= -716.071230638462  delta_E= -0.286  |g|= 5.92  |ddm|= 0.304
  HOMO = 0.128338526190075  LUMO = 0.189012321010287
cycle= 14 E= -716.523947101025  delta_E= -0.453  |g|= 5.85  |ddm|= 0.544
  HOMO = 0.160457940646769  LUMO = 0.195805224593954
cycle= 15 E= -716.769838630332  delta_E= -0.246  |g|= 5.88  |ddm|= 0.512
  HOMO = 0.199353361353328  LUMO = 0.234824984886644
cycle= 16 E= -714.877288440978  delta_E= 1.89  |g|= 6.42  |ddm|= 0.822
  HOMO = 0.170110829651319  LUMO = 0.19240334548543
cycle= 17 E= -717.886249190974  delta_E= -3.01  |g|= 5.66  |ddm|= 1.35
  HOMO = 0.435409423297402  LUMO = 0.442455356398214
cycle= 18 E= -639.681878045333  delta_E= 78.2  |g|= 11.8  |ddm|= 7.66
  HOMO = 0.169034927073245  LUMO = 0.179049934800258
cycle= 19 E= -721.843098916606  delta_E= -82.2  |g|= 3.91  |ddm|= 7.56
  HOMO = 0.161439043399962  LUMO = 0.163257764411703
cycle= 20 E= -723.613043318443  delta_E= -1.77  |g|= 2.57  |ddm|= 1.45
  HOMO = 0.166224332865141  LUMO = 0.174256948127634
cycle= 21 E= -723.878622258975  delta_E= -0.266  |g|= 2.02  |ddm|=  2.2
  HOMO = 0.16553677691048  LUMO = 0.240659452627432
cycle= 22 E= -723.852228628844  delta_E= 0.0264  |g|= 1.86  |ddm|= 2.04
  HOMO = 0.157983755901412  LUMO = 0.290400638839201
cycle= 23 E= -723.66873340679  delta_E= 0.183  |g|= 1.84  |ddm|= 2.09

WARN: HOMO 0.269631728304029 >= LUMO 0.269823774195368

cycle= 24 E= -714.646196944371  delta_E= 9.02  |g|= 5.71  |ddm|= 4.26
  HOMO = 0.292791911589647  LUMO = 0.294133754390758
cycle= 25 E= -706.36795316441  delta_E= 8.28  |g|= 5.99  |ddm|= 3.82
  HOMO = 0.193259813139215  LUMO = 0.19875408557016
cycle= 26 E= -719.088103458502  delta_E= -12.7  |g|= 5.28  |ddm|= 3.64
  HOMO = 0.18282225869227  LUMO = 0.19136454727046
cycle= 27 E= -720.700752195141  delta_E= -1.61  |g|= 4.37  |ddm|= 0.914
  HOMO = 0.17271743230528  LUMO = 0.187118350224408
cycle= 28 E= -721.110717925483  delta_E= -0.41  |g|= 4.04  |ddm|= 1.08
  HOMO = 0.173925951967453  LUMO = 0.182736771580704
cycle= 29 E= -721.713054552074  delta_E= -0.602  |g|= 3.85  |ddm|= 1.34
  HOMO = 0.173017972511294  LUMO = 0.188191675300941
cycle= 30 E= -722.786504465482  delta_E= -1.07  |g|= 3.29  |ddm|= 0.998
  HOMO = 0.233050225385816  LUMO = 0.267363720284326
cycle= 31 E= -722.620617376038  delta_E= 0.166  |g|= 2.93  |ddm|=  2.8
  HOMO = 0.40826108518937  LUMO = 0.486190851633943
cycle= 32 E= -689.156488344051  delta_E= 33.5  |g|= 7.67  |ddm|= 6.15
  HOMO = 0.271006580028132  LUMO = 0.296358296188433
cycle= 33 E= -721.82251024712  delta_E= -32.7  |g|= 3.89  |ddm|= 5.17
  HOMO = 0.224600112985753  LUMO = 0.241271519130888
cycle= 34 E= -723.302083131242  delta_E= -1.48  |g|= 2.94  |ddm|= 2.11
  HOMO = 0.201697482263648  LUMO = 0.203692500065967
cycle= 35 E= -721.239250818634  delta_E= 2.06  |g|= 3.21  |ddm|= 2.53
  HOMO = 0.183417624950436  LUMO = 0.206534050891794
cycle= 36 E= -723.849496588889  delta_E= -2.61  |g|= 2.29  |ddm|= 2.47
  HOMO = 0.199594844461777  LUMO = 0.221063465577045
cycle= 37 E= -723.840787338547  delta_E= 0.00871  |g|= 2.18  |ddm|= 1.53

WARN: HOMO 0.189155969287091 >= LUMO 0.189610604459366

cycle= 38 E= -724.104590616519  delta_E= -0.264  |g|= 2.06  |ddm|= 1.55
  HOMO = 0.195365760031517  LUMO = 0.198163984043854
cycle= 39 E= -723.18998483517  delta_E= 0.915  |g|= 2.78  |ddm|= 2.15
  HOMO = 0.188901883881772  LUMO = 0.197293534286937
cycle= 40 E= -723.963748187822  delta_E= -0.774  |g|= 2.12  |ddm|= 2.41
  HOMO = 0.289241929322072  LUMO = 0.384525211486003
cycle= 41 E= -691.26206917726  delta_E= 32.7  |g|= 7.28  |ddm|= 5.39
  HOMO = 0.178826770285041  LUMO = 0.197475855725025
cycle= 42 E= -724.128548255837  delta_E= -32.9  |g|= 2.01  |ddm|=  5.4
  HOMO = 0.170654936387667  LUMO = 0.195230741420199
cycle= 43 E= -724.187978729582  delta_E= -0.0594  |g|= 1.92  |ddm|= 0.355
  HOMO = 0.21371760478427  LUMO = 0.257970583038995
cycle= 44 E= -719.72784746524  delta_E= 4.46  |g|= 3.99  |ddm|= 3.01
  HOMO = 0.182656894639533  LUMO = 0.210772263207506
cycle= 45 E= -722.586719621248  delta_E= -2.86  |g|= 3.04  |ddm|=  2.6
  HOMO = 0.231433037948213  LUMO = 0.232893365587037
cycle= 46 E= -715.897150730233  delta_E= 6.69  |g|= 5.58  |ddm|=  3.4
  HOMO = 0.184724366624357  LUMO = 0.208671873329394
cycle= 47 E= -723.998700649687  delta_E= -8.1  |g|= 1.79  |ddm|= 3.72

WARN: HOMO 0.161586556768293 >= LUMO 0.162367421523523

cycle= 48 E= -723.758734762768  delta_E= 0.24  |g|= 2.39  |ddm|= 2.24
  HOMO = 0.150886038224713  LUMO = 0.214124777619559
cycle= 49 E= -724.291964821696  delta_E= -0.533  |g|=  1.5  |ddm|= 1.57
  HOMO = 0.20142033960303  LUMO = 0.224000502079692
cycle= 50 E= -715.816118461635  delta_E= 8.48  |g|= 5.29  |ddm|= 3.69
  HOMO = 0.192415412779869  LUMO = 0.212837751748564
cycle= 51 E= -723.419174980867  delta_E= -7.6  |g|= 2.07  |ddm|= 3.62
  HOMO = 0.166921474795694  LUMO = 0.186661647068549
cycle= 52 E= -724.847102811376  delta_E= -1.43  |g|= 0.91  |ddm|= 2.04
  HOMO = 0.178653920593291  LUMO = 0.187403825999406
cycle= 53 E= -723.478707370367  delta_E= 1.37  |g|= 2.51  |ddm|= 2.31
  HOMO = 0.181007587617442  LUMO = 0.1979507860312
cycle= 54 E= -724.03068982264  delta_E= -0.552  |g|= 2.27  |ddm|= 2.71
  HOMO = 0.174188888132605  LUMO = 0.20910193611518
cycle= 55 E= -724.893960282083  delta_E= -0.863  |g|= 1.15  |ddm|=  1.9
  HOMO = 0.173617574072154  LUMO = 0.208644738445265
cycle= 56 E= -724.897927464164  delta_E= -0.00397  |g|= 1.14  |ddm|= 0.0207
  HOMO = 0.180035305336199  LUMO = 0.194576517427682
cycle= 57 E= -724.947801143358  delta_E= -0.0499  |g|= 0.943  |ddm|= 0.279
  HOMO = 0.195974865968261  LUMO = 0.215287846353058
cycle= 58 E= -723.528550196709  delta_E= 1.42  |g|= 2.38  |ddm|=  2.2
  HOMO = 0.182771127446058  LUMO = 0.211075098756373
cycle= 59 E= -724.97832095225  delta_E= -1.45  |g|= 0.854  |ddm|= 2.08
  HOMO = 0.189288205250476  LUMO = 0.210629053068346
cycle= 60 E= -725.058934896995  delta_E= -0.0806  |g|= 0.441  |ddm|= 0.488
  HOMO = 0.198132570209338  LUMO = 0.21881443119097
cycle= 61 E= -724.926154864529  delta_E= 0.133  |g|= 0.888  |ddm|= 1.13
  HOMO = 0.1845627783006  LUMO = 0.221678808933369
cycle= 62 E= -725.092545379571  delta_E= -0.166  |g|= 0.244  |ddm|= 0.903
  HOMO = 0.18486759302583  LUMO = 0.218073523465749
cycle= 63 E= -725.098740138915  delta_E= -0.00619  |g|= 0.154  |ddm|= 0.207
  HOMO = 0.180832284408011  LUMO = 0.221881390279963
cycle= 64 E= -725.103485210505  delta_E= -0.00475  |g|= 0.0611  |ddm|= 0.148
  HOMO = 0.179031293485064  LUMO = 0.221015444621053
cycle= 65 E= -725.103657366022  delta_E= -0.000172  |g|= 0.0573  |ddm|= 0.053
  HOMO = 0.180011644455208  LUMO = 0.220214380580591
cycle= 66 E= -725.104096523763  delta_E= -0.000439  |g|= 0.0372  |ddm|= 0.0414
  HOMO = 0.184568697646663  LUMO = 0.216092670384591
cycle= 67 E= -725.104154980807  delta_E= -5.85e-05  |g|= 0.0432  |ddm|= 0.0834
  HOMO = 0.182971869669583  LUMO = 0.219487214996014
cycle= 68 E= -725.104534369286  delta_E= -0.000379  |g|= 0.00994  |ddm|= 0.0378
  HOMO = 0.182500376276918  LUMO = 0.219245512322448
cycle= 69 E= -725.104561754453  delta_E= -2.74e-05  |g|= 0.00684  |ddm|= 0.00839
  HOMO = 0.18251885580045  LUMO = 0.219609651963236
cycle= 70 E= -725.104599530999  delta_E= -3.78e-05  |g|= 0.00507  |ddm|= 0.0105
  HOMO = 0.182657284759732  LUMO = 0.219573173166865
cycle= 71 E= -725.104617818785  delta_E= -1.83e-05  |g|= 0.00482  |ddm|= 0.00555
  HOMO = 0.182625071758327  LUMO = 0.219593516059239
cycle= 72 E= -725.104637073248  delta_E= -1.93e-05  |g|= 0.00463  |ddm|= 0.00455
  HOMO = 0.182634425066278  LUMO = 0.219606734057462
cycle= 73 E= -725.104690145771  delta_E= -5.31e-05  |g|= 0.00452  |ddm|= 0.0122
  HOMO = 0.182680958900463  LUMO = 0.219533940334254
cycle= 74 E= -725.104826205089  delta_E= -0.000136  |g|= 0.00439  |ddm|= 0.0322
  HOMO = 0.182779171757297  LUMO = 0.219748498850769
cycle= 75 E= -725.10504012532  delta_E= -0.000214  |g|= 0.00417  |ddm|= 0.0549
  HOMO = 0.182902479475216  LUMO = 0.219602061683715
cycle= 76 E= -725.105401514325  delta_E= -0.000361  |g|= 0.00597  |ddm|= 0.115
  HOMO = 0.182885987540655  LUMO = 0.219479831040495
cycle= 77 E= -725.105203582805  delta_E= 0.000198  |g|= 0.00478  |ddm|= 0.069
  HOMO = 0.182775090978021  LUMO = 0.219611014739736
cycle= 78 E= -725.105480089161  delta_E= -0.000277  |g|= 0.00432  |ddm|= 0.0945
  HOMO = 0.182858655270558  LUMO = 0.219662273262222
cycle= 79 E= -725.105526891526  delta_E= -4.68e-05  |g|= 0.00348  |ddm|= 0.017
  HOMO = 0.182846935306625  LUMO = 0.219586833516489
cycle= 80 E= -725.105587258533  delta_E= -6.04e-05  |g|= 0.00463  |ddm|= 0.0253
  HOMO = 0.182854617866952  LUMO = 0.219451108492494
cycle= 81 E= -725.105746708979  delta_E= -0.000159  |g|= 0.0045  |ddm|= 0.0765
  HOMO = 0.182838877595563  LUMO = 0.219715635862714
cycle= 82 E= -725.105842776854  delta_E= -9.61e-05  |g|= 0.00503  |ddm|= 0.0682
  HOMO = 0.182817431179585  LUMO = 0.219712911316452
cycle= 83 E= -725.105862794593  delta_E= -2e-05  |g|= 0.00526  |ddm|= 0.0177
  HOMO = 0.18283859016895  LUMO = 0.219802369236416
cycle= 84 E= -725.105882385511  delta_E= -1.96e-05  |g|= 0.00499  |ddm|= 0.0159
  HOMO = 0.182830364124824  LUMO = 0.219778258868082
cycle= 85 E= -725.105889575204  delta_E= -7.19e-06  |g|= 0.00377  |ddm|= 0.00303
  HOMO = 0.182866155672595  LUMO = 0.219682233024936
cycle= 86 E= -725.105906695487  delta_E= -1.71e-05  |g|= 0.00217  |ddm|= 0.00908
  HOMO = 0.182853096748667  LUMO = 0.219642604978601
cycle= 87 E= -725.105925243836  delta_E= -1.85e-05  |g|= 0.00221  |ddm|= 0.0149
  HOMO = 0.182879664320569  LUMO = 0.219642514992401
cycle= 88 E= -725.105938790486  delta_E= -1.35e-05  |g|= 0.00211  |ddm|= 0.00964
  HOMO = 0.182869032821466  LUMO = 0.219631876593437
cycle= 89 E= -725.105943064848  delta_E= -4.27e-06  |g|= 0.00205  |ddm|= 0.00352
  HOMO = 0.182872817363688  LUMO = 0.219613521997967
cycle= 90 E= -725.105942886646  delta_E= 1.78e-07  |g|= 0.00207  |ddm|= 0.00285
  HOMO = 0.182882001834863  LUMO = 0.219618829097641
cycle= 91 E= -725.105946698923  delta_E= -3.81e-06  |g|= 0.00206  |ddm|= 0.00279
  HOMO = 0.182882669872669  LUMO = 0.219604340421875
cycle= 92 E= -725.105947974709  delta_E= -1.28e-06  |g|= 0.00206  |ddm|= 0.000737
  HOMO = 0.182880670755662  LUMO = 0.219612003364767
cycle= 93 E= -725.10594638053  delta_E= 1.59e-06  |g|= 0.00206  |ddm|= 0.000843
  HOMO = 0.182889201590287  LUMO = 0.21960657389633
cycle= 94 E= -725.105948705516  delta_E= -2.32e-06  |g|= 0.00206  |ddm|= 0.00161
  HOMO = 0.182887826976883  LUMO = 0.219603747270428
cycle= 95 E= -725.105946503172  delta_E= 2.2e-06  |g|= 0.00206  |ddm|= 0.00192
  HOMO = 0.182885609240005  LUMO = 0.219604209173394
cycle= 96 E= -725.105939647201  delta_E= 6.86e-06  |g|= 0.00206  |ddm|= 0.00552
  HOMO = 0.182868182719709  LUMO = 0.219568179289614
cycle= 97 E= -725.105926618614  delta_E= 1.3e-05  |g|= 0.00205  |ddm|= 0.0101
  HOMO = 0.182871229810487  LUMO = 0.219603052498818
cycle= 98 E= -725.105923737468  delta_E= 2.88e-06  |g|= 0.00206  |ddm|= 0.00229
  HOMO = 0.182877751949537  LUMO = 0.219585956295659
cycle= 99 E= -725.105915464558  delta_E= 8.27e-06  |g|= 0.00207  |ddm|= 0.00565
  HOMO = 0.182877654727983  LUMO = 0.219561855985932
cycle= 100 E= -725.105914245524  delta_E= 1.22e-06  |g|= 0.00204  |ddm|= 0.000891
SCF not converged.
SCF energy = -725.105914245524




******** <class 'pyscf.soscf.newton_ah.SecondOrderROHF'> ********
method = SecondOrderROHF
initial guess = chk
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-10
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.1.chk
max_memory 500000 MB (current use 9871 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = None
DF object = <pyscf.pbc.df.df.GDF object at 0x7f23ec366eb0>
number of electrons per cell  alpha = 48 beta = 48
******** <class 'pyscf.pbc.scf.rohf.ROHF'> Newton solver flags ********
SCF tol = 1e-10
conv_tol_grad = None
max. SCF cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = NiO_3.1.chk
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 500000 MB (current use 9871 MB)
Set conv_tol_grad to 1e-05


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
  HOMO = 0.182863090802617  LUMO = 0.219610117124627
Initial guess E= -725.105914245524  |g|= 0.00204122
macro= 0  E= -725.106274049434  delta_E= -0.000359804  |g|= 0.00204122  1 KF 5 JK
macro= 1  E= -725.107157523126  delta_E= -0.000883474  |g|= 0.066965  3 KF 15 JK
macro= 2  E= -725.117096460491  delta_E= -0.00993894  |g|= 0.149988  3 KF 18 JK
macro= 3  E= -725.121029683297  delta_E= -0.00393322  |g|= 0.00705559  4 KF 19 JK
macro= 4  E= -725.121465655524  delta_E= -0.000435972  |g|= 0.00108607  4 KF 29 JK
macro= 5  E= -725.121465689253  delta_E= -3.37293e-08  |g|= 2.38348e-05  3 KF 27 JK
macro= 6  E= -725.121465689254  delta_E= -6.82121e-13  |g|= 3.14842e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 7  E=-725.121465689254  |g|= 3.14842e-06  total 20 KF 123 JK
converged SCF energy = -725.121465689254


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.940072e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 5.454284e-05 ; sigma = 2.666355e-03 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 6.177023e-08 ; sigma = 1.161385e-07 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 5.629874e-11 ; sigma = 9.947598e-14 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 3 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 5.260680e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 1.263800e-03 ; sigma = 3.748400e-03 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 1.711724e-06 ; sigma = 6.458188e-05 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 5.639530e-07 ; sigma = 1.912213e-10 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 3.303224e-07 ; sigma = 1.335820e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 5.301637e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 1.563843e-03 ; sigma = 1.167835e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 6.909323e-05 ; sigma = 1.038883e-04 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 1.075525e-05 ; sigma = 7.216730e-07 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.122016e-06 ; sigma = 5.059377e-09 ; 2/2 fragment CI solvers converged
Cycle 5: max grad = 9.635443e-07 ; sigma = 7.354117e-11 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 5 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 3.377303e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 3.815014e-05 ; sigma = 2.496555e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 3.261662e-07 ; sigma = 3.179283e-07 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 1.070711e-09 ; sigma = 5.144329e-12 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 3 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 3.520643e-02 ; sigma = 0.000000e+00 ; 0/2 fragment CI solvers converged
Cycle 1: max grad = 5.374776e-05 ; sigma = 2.774886e-02 ; 2/2 fragment CI solvers converged
Cycle 2: max grad = 1.961875e-06 ; sigma = 2.919651e-06 ; 2/2 fragment CI solvers converged
Cycle 3: max grad = 6.248466e-09 ; sigma = 1.594458e-10 ; 2/2 fragment CI solvers converged
Cycle 4: max grad = 1.499096e-10 ; sigma = 1.421085e-14 ; 2/2 fragment CI solvers converged
Product_state fixed-point CI iteration converged after 4 cycles
LASCI state-average energy = -725.149678122708
LASCI state 0 energy = -725.40886807389
LASCI state 1 energy = -725.035884351318
LASCI state 2 energy = -725.027874600685
LASCI state 3 energy = -725.138213411373
LASCI state 4 energy = -725.137550176273
******** LAS space tables ********
LAS space 0: (16e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.40886807389
S^2 = 0.0000000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 1: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.035884351318
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+7e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 2: (16e+15e,20o) wfynsm=A
Converged? True
E(LAS) = -725.027874600685
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (8e+7e,10o)     2    A        1
LAS space 3: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.138213411373
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (9e+8e,10o)     2    A        1
    1   (8e+8e,10o)     1    A        1
LAS space 4: (17e+16e,20o) wfynsm=A
Converged? True
E(LAS) = -725.137550176273
S^2 = 0.7500000 (Pure)
Space table
 frag    (ae+be,no)  2S+1   ir   lroots
    0   (8e+8e,10o)     1    A        1
    1   (9e+8e,10o)     2    A        1
LASSI op_o0 memory check: 1709.058096 MB needed of 490166.413312 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
Symmetry analysis of 5 LAS rootspaces:
 ix            Energy  <S**2>  Neleca  Nelecb  Nelec   Wfnsym
  0   -725.4088680739   0.000      16      16      32       A
  1   -725.0358843513   0.750      16      15      31       A
  2   -725.0278746007   0.750      16      15      31       A
  3   -725.1382134114   0.750      17      16      33       A
  4   -725.1375501763   0.750      17      16      33       A
Build + diag H matrix LASSI symmetry block 0
['neleca', 'nelecb', 'irrep'] = (17, 16, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 123.54336 MB needed of 490170.923008 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 1
['neleca', 'nelecb', 'irrep'] = (16, 15, 0)
(2 rootspaces; 2 states)
LASSI op_o0 memory check: 1652.196096 MB needed of 490170.923008 MB available (500000 MB max)
2/2 linearly independent model states
Build + diag H matrix LASSI symmetry block 2
['neleca', 'nelecb', 'irrep'] = (16, 16, 0)
(1 rootspaces; 1 states)
LASSI eigenvalues (5 total):
 ix            Energy  <S**2>  Neleca  Nelecb  Wfnsym
  0   -725.4088680739   0.000      16      16       A
  1   -725.1382134114   0.750      17      16       A
  2   -725.1375501763   0.750      17      16       A
  3   -725.0358843513   0.750      16      15       A
  4   -725.0278746007   0.750      16      15       A
Building tPBE functional
Building tPBE functional
Periodic OT-FNAL class is used
LASSI op_o0 memory check: 1709.058096 MB needed of 490170.923008 MB available (500000 MB max)


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 0 E = -740.396391515313, Eot(tPBE) = -81.11069488264222


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 1 E = -740.3108610071805, Eot(tPBE) = -82.14819340447924


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 2 E = -740.3151955433126, Eot(tPBE) = -82.14903676362849


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 3 E = -739.8675883231108, Eot(tPBE) = -80.05919074485104


******** <class 'pyscf.pbc.df.rsdf_builder._RSNucBuilder'> ********
mesh = [29 29 55] (46255 PWs)
ke_cutoff = 17.47128732304127
omega = 0.45268479519678895
exclude_d_aux = False
exclude_dd_block = True
j2c_eig_always = False
has_long_range = True
MC-PDFT state 4 E = -739.916188524408, Eot(tPBE) = -80.04522608868884
